!function(e,t){"use strict";"undefined"!=typeof t&&(t.define("PublicaMundi.Leaflet"),t.Leaflet.Framework="leaflet",t.registerFrameworkResolver(t.Leaflet.Framework,function(){return t.isObject(L)&&t.isFunction(L.Map)?!0:!1}))}(window,PublicaMundi),toGeoJSON=function(){"use strict";function e(e){if(!e||!e.length)return 0;for(var t=0,n=0;t<e.length;t++)n=(n<<5)-n+e.charCodeAt(t)|0;return n}function t(e,t){return e.getElementsByTagName(t)}function n(e,t){return e.getAttribute(t)}function r(e,t){return parseFloat(n(e,t))}function i(e,n){var r=t(e,n);return r.length?r[0]:null}function s(e){return e.normalize&&e.normalize(),e}function o(e){for(var t=0,n=[];t<e.length;t++)n[t]=parseFloat(e[t]);return n}function u(e){var t={};for(var n in e)e[n]&&(t[n]=e[n]);return t}function a(e){return e&&s(e),e&&e.firstChild&&e.firstChild.nodeValue||""}function f(e){return o(e.replace(v,"").split(","))}function l(e){for(var t=e.replace(m,"").split(g),n=[],r=0;r<t.length;r++)n.push(f(t[r]));return n}function c(e){var t=[r(e,"lon"),r(e,"lat")],n=i(e,"ele");return n&&t.push(parseFloat(a(n))),t}function h(){return{type:"FeatureCollection",features:[]}}function p(e){return d.serializeToString(e)}var d,v=/\s*/g,m=/^\s*|\s*$/g,g=/\s+/;"undefined"!=typeof XMLSerializer?d=new XMLSerializer:"object"!=typeof exports||"object"!=typeof process||process.browser||(d=new(require("xmldom").XMLSerializer));var y={kml:function(r){function s(e){var t,n;return e=e||"","#"===e.substr(0,1)&&(e=e.substr(1)),(6===e.length||3===e.length)&&(t=e),8===e.length&&(n=parseInt(e.substr(0,2),16)/255,t=e.substr(2)),[t,isNaN(n)?void 0:n]}function u(e){return o(e.split(" "))}function c(e){var n=t(e,"coord","gx"),r=[];0===n.length&&(n=t(e,"gx:coord"));for(var i=0;i<n.length;i++)r.push(u(a(n[i])));return r}function d(e){var n,r,s,o,u,h=[];if(i(e,"MultiGeometry"))return d(i(e,"MultiGeometry"));if(i(e,"MultiTrack"))return d(i(e,"MultiTrack"));if(i(e,"gx:MultiTrack"))return d(i(e,"gx:MultiTrack"));for(s=0;s<y.length;s++)if(r=t(e,y[s]))for(o=0;o<r.length;o++)if(n=r[o],"Point"==y[s])h.push({type:"Point",coordinates:f(a(i(n,"coordinates")))});else if("LineString"==y[s])h.push({type:"LineString",coordinates:l(a(i(n,"coordinates")))});else if("Polygon"==y[s]){var p=t(n,"LinearRing"),v=[];for(u=0;u<p.length;u++)v.push(l(a(i(p[u],"coordinates"))));h.push({type:"Polygon",coordinates:v})}else("Track"==y[s]||"gx:Track"==y[s])&&h.push({type:"LineString",coordinates:c(n)});return h}function v(e){var n,r=d(e),o={},u=a(i(e,"name")),f=a(i(e,"styleUrl")),l=a(i(e,"description")),c=i(e,"TimeSpan"),h=i(e,"ExtendedData"),p=i(e,"LineStyle"),v=i(e,"PolyStyle");if(!r.length)return[];if(u&&(o.name=u),f&&g[f]&&(o.styleUrl=f,o.styleHash=g[f]),l&&(o.description=l),c){var m=a(i(c,"begin")),y=a(i(c,"end"));o.timespan={begin:m,end:y}}if(p){var w=s(a(i(p,"color"))),E=w[0],S=w[1],x=parseFloat(a(i(p,"width")));E&&(o.stroke=E),isNaN(S)||(o["stroke-opacity"]=S),isNaN(x)||(o["stroke-width"]=x)}if(v){var T=s(a(i(v,"color"))),N=T[0],C=T[1],k=a(i(v,"fill")),L=a(i(v,"outline"));N&&(o.fill=N),isNaN(C)||(o["fill-opacity"]=C),k&&(o["fill-opacity"]="1"===k?1:0),L&&(o["stroke-opacity"]="1"===L?1:0)}if(h){var A=t(h,"Data"),O=t(h,"SimpleData");for(n=0;n<A.length;n++)o[A[n].getAttribute("name")]=a(i(A[n],"value"));for(n=0;n<O.length;n++)o[O[n].getAttribute("name")]=a(O[n])}return[{type:"Feature",geometry:1===r.length?r[0]:{type:"GeometryCollection",geometries:r},properties:o}]}for(var m=h(),g={},y=["Polygon","LineString","Point","Track","gx:Track"],w=t(r,"Placemark"),E=t(r,"Style"),S=0;S<E.length;S++)g["#"+n(E[S],"id")]=e(p(E[S])).toString(16);for(var x=0;x<w.length;x++)m.features=m.features.concat(v(w[x]));return m},gpx:function(e){function n(e,n){var r=t(e,n),i=[],s=r.length;if(!(2>s)){for(var o=0;s>o;o++)i.push(c(r[o]));return i}}function r(e){for(var r,i=t(e,"trkseg"),s=[],o=0;o<i.length;o++)r=n(i[o],"trkpt"),r&&s.push(r);return 0!==s.length?{type:"Feature",properties:f(e),geometry:{type:1===s.length?"LineString":"MultiLineString",coordinates:1===s.length?s[0]:s}}:void 0}function s(e){var t=n(e,"rtept");if(t)return{type:"Feature",properties:f(e),geometry:{type:"LineString",coordinates:t}}}function o(e){var t=f(e);return t.sym=a(i(e,"sym")),{type:"Feature",properties:t,geometry:{type:"Point",coordinates:c(e)}}}function f(e){var t,n=["name","desc","author","copyright","link","time","keywords"],r={};for(t=0;t<n.length;t++)r[n[t]]=a(i(e,n[t]));return u(r)}var l,p,d=t(e,"trk"),v=t(e,"rte"),m=t(e,"wpt"),g=h();for(l=0;l<d.length;l++)p=r(d[l]),p&&g.features.push(p);for(l=0;l<v.length;l++)p=s(v[l]),p&&g.features.push(p);for(l=0;l<m.length;l++)g.features.push(o(m[l]));return g}};return y}(),"undefined"!=typeof module&&(module.exports=toGeoJSON),!function(e){if("object"==typeof exports)module.exports=e();else if("function"==typeof define&&define.amd)define(e);else{var t;"undefined"!=typeof window?t=window:"undefined"!=typeof global?t=global:"undefined"!=typeof self&&(t=self),t.proj4=e()}}(function(){return function e(t,n,r){function i(o,u){if(!n[o]){if(!t[o]){var l="function"==typeof require&&require;if(!u&&l)return l(o,!0);if(s)return s(o,!0);throw new Error("Cannot find module '"+o+"'")}var h=n[o]={exports:{}};t[o][0].call(h.exports,function(e){var n=t[o][1][e];return i(n?n:e)},h,h.exports,e,t,n,r)}return n[o].exports}for(var s="function"==typeof require&&require,o=0;o<r.length;o++)i(r[o]);return i}({1:[function(e,t){function n(e,t,r){if(!(this instanceof n))return new n(e,t,r);if(Array.isArray(e))this.x=e[0],this.y=e[1],this.z=e[2]||0;else if("object"==typeof e)this.x=e.x,this.y=e.y,this.z=e.z||0;else if("string"==typeof e&&"undefined"==typeof t){var i=e.split(",");this.x=parseFloat(i[0],10),this.y=parseFloat(i[1],10),this.z=parseFloat(i[2],10)||0}else this.x=e,this.y=t,this.z=r||0;console.warn("proj4.Point will be removed in version 3, use proj4.toPoint")}var r=e("mgrs");n.fromMGRS=function(e){return new n(r.toPoint(e))},n.prototype.toMGRS=function(e){return r.forward([this.x,this.y],e)},t.exports=n},{mgrs:66}],2:[function(e,t){function n(e,t){if(!(this instanceof n))return new n(e);t=t||function(e){if(e)throw e};var s=r(e);if("object"!=typeof s)return void t(e);var u=o(s),a=n.projections.get(u.projName);a?(i(this,u),i(this,a),this.init(),t(null,this)):t(e)}var r=e("./parseCode"),i=e("./extend"),s=e("./projections"),o=e("./deriveConstants");n.projections=s,n.projections.start(),t.exports=n},{"./deriveConstants":32,"./extend":33,"./parseCode":36,"./projections":38}],3:[function(e,t){t.exports=function(e,t,n){var r,i,s,o=n.x,u=n.y,a=n.z||0;for(s=0;3>s;s++)if(!t||2!==s||void 0!==n.z)switch(0===s?(r=o,i="x"):1===s?(r=u,i="y"):(r=a,i="z"),e.axis[s]){case"e":n[i]=r;break;case"w":n[i]=-r;break;case"n":n[i]=r;break;case"s":n[i]=-r;break;case"u":void 0!==n[i]&&(n.z=r);break;case"d":void 0!==n[i]&&(n.z=-r);break;default:return null}return n}},{}],4:[function(e,t){var n=Math.PI/2,r=e("./sign");t.exports=function(e){return Math.abs(e)<n?e:e-r(e)*Math.PI}},{"./sign":21}],5:[function(e,t){var n=2*Math.PI,r=e("./sign");t.exports=function(e){return Math.abs(e)<Math.PI?e:e-r(e)*n}},{"./sign":21}],6:[function(e,t){t.exports=function(e){return Math.abs(e)>1&&(e=e>1?1:-1),Math.asin(e)}},{}],7:[function(e,t){t.exports=function(e){return 1-.25*e*(1+e/16*(3+1.25*e))}},{}],8:[function(e,t){t.exports=function(e){return.375*e*(1+.25*e*(1+.46875*e))}},{}],9:[function(e,t){t.exports=function(e){return.05859375*e*e*(1+.75*e)}},{}],10:[function(e,t){t.exports=function(e){return e*e*e*(35/3072)}},{}],11:[function(e,t){t.exports=function(e,t,n){var r=t*n;return e/Math.sqrt(1-r*r)}},{}],12:[function(e,t){t.exports=function(e,t,n,r,i){var s,o;s=e/t;for(var u=0;15>u;u++)if(o=(e-(t*s-n*Math.sin(2*s)+r*Math.sin(4*s)-i*Math.sin(6*s)))/(t-2*n*Math.cos(2*s)+4*r*Math.cos(4*s)-6*i*Math.cos(6*s)),s+=o,Math.abs(o)<=1e-10)return s;return NaN}},{}],13:[function(e,t){var n=Math.PI/2;t.exports=function(e,t){var r=1-(1-e*e)/(2*e)*Math.log((1-e)/(1+e));if(Math.abs(Math.abs(t)-r)<1e-6)return 0>t?-1*n:n;for(var i,s,o,u,a=Math.asin(.5*t),f=0;30>f;f++)if(s=Math.sin(a),o=Math.cos(a),u=e*s,i=Math.pow(1-u*u,2)/(2*o)*(t/(1-e*e)-s/(1-u*u)+.5/e*Math.log((1-u)/(1+u))),a+=i,Math.abs(i)<=1e-10)return a;return NaN}},{}],14:[function(e,t){t.exports=function(e,t,n,r,i){return e*i-t*Math.sin(2*i)+n*Math.sin(4*i)-r*Math.sin(6*i)}},{}],15:[function(e,t){t.exports=function(e,t,n){var r=e*t;return n/Math.sqrt(1-r*r)}},{}],16:[function(e,t){var n=Math.PI/2;t.exports=function(e,t){for(var r,i,s=.5*e,o=n-2*Math.atan(t),u=0;15>=u;u++)if(r=e*Math.sin(o),i=n-2*Math.atan(t*Math.pow((1-r)/(1+r),s))-o,o+=i,Math.abs(i)<=1e-10)return o;return-9999}},{}],17:[function(e,t){var n=1,r=.25,i=.046875,s=.01953125,o=.01068115234375,u=.75,a=.46875,f=.013020833333333334,l=.007120768229166667,c=.3645833333333333,h=.005696614583333333,p=.3076171875;t.exports=function(e){var t=[];t[0]=n-e*(r+e*(i+e*(s+e*o))),t[1]=e*(u-e*(i+e*(s+e*o)));var v=e*e;return t[2]=v*(a-e*(f+e*l)),v*=e,t[3]=v*(c-e*h),t[4]=v*e*p,t}},{}],18:[function(e,t){var n=e("./pj_mlfn"),r=1e-10,i=20;t.exports=function(e,t,s){for(var o=1/(1-t),u=e,a=i;a;--a){var f=Math.sin(u),l=1-t*f*f;if(l=(n(u,f,Math.cos(u),s)-e)*l*Math.sqrt(l)*o,u-=l,Math.abs(l)<r)return u}return u}},{"./pj_mlfn":19}],19:[function(e,t){t.exports=function(e,t,n,r){return n*=t,t*=t,r[0]*e-n*(r[1]+t*(r[2]+t*(r[3]+t*r[4])))}},{}],20:[function(e,t){t.exports=function(e,t){var n;return e>1e-7?(n=e*t,(1-e*e)*(t/(1-n*n)-.5/e*Math.log((1-n)/(1+n)))):2*t}},{}],21:[function(e,t){t.exports=function(e){return 0>e?-1:1}},{}],22:[function(e,t){t.exports=function(e,t){return Math.pow((1-e)/(1+e),t)}},{}],23:[function(e,t){t.exports=function(e){var t={x:e[0],y:e[1]};return e.length>2&&(t.z=e[2]),e.length>3&&(t.m=e[3]),t}},{}],24:[function(e,t){var n=Math.PI/2;t.exports=function(e,t,r){var i=e*r,s=.5*e;return i=Math.pow((1-i)/(1+i),s),Math.tan(.5*(n-t))/i}},{}],25:[function(e,t,n){n.wgs84={towgs84:"0,0,0",ellipse:"WGS84",datumName:"WGS84"},n.ch1903={towgs84:"674.374,15.056,405.346",ellipse:"bessel",datumName:"swiss"},n.ggrs87={towgs84:"-199.87,74.79,246.62",ellipse:"GRS80",datumName:"Greek_Geodetic_Reference_System_1987"},n.nad83={towgs84:"0,0,0",ellipse:"GRS80",datumName:"North_American_Datum_1983"},n.nad27={nadgrids:"@conus,@alaska,@ntv2_0.gsb,@ntv1_can.dat",ellipse:"clrk66",datumName:"North_American_Datum_1927"},n.potsdam={towgs84:"606.0,23.0,413.0",ellipse:"bessel",datumName:"Potsdam Rauenberg 1950 DHDN"},n.carthage={towgs84:"-263.0,6.0,431.0",ellipse:"clark80",datumName:"Carthage 1934 Tunisia"},n.hermannskogel={towgs84:"653.0,-212.0,449.0",ellipse:"bessel",datumName:"Hermannskogel"},n.ire65={towgs84:"482.530,-130.596,564.557,-1.042,-0.214,-0.631,8.15",ellipse:"mod_airy",datumName:"Ireland 1965"},n.rassadiran={towgs84:"-133.63,-157.5,-158.62",ellipse:"intl",datumName:"Rassadiran"},n.nzgd49={towgs84:"59.47,-5.04,187.44,0.47,-0.1,1.024,-4.5993",ellipse:"intl",datumName:"New Zealand Geodetic Datum 1949"},n.osgb36={towgs84:"446.448,-125.157,542.060,0.1502,0.2470,0.8421,-20.4894",ellipse:"airy",datumName:"Airy 1830"},n.s_jtsk={towgs84:"589,76,480",ellipse:"bessel",datumName:"S-JTSK (Ferro)"},n.beduaram={towgs84:"-106,-87,188",ellipse:"clrk80",datumName:"Beduaram"},n.gunung_segara={towgs84:"-403,684,41",ellipse:"bessel",datumName:"Gunung Segara Jakarta"},n.rnb72={towgs84:"106.869,-52.2978,103.724,-0.33657,0.456955,-1.84218,1",ellipse:"intl",datumName:"Reseau National Belge 1972"}},{}],26:[function(e,t,n){n.MERIT={a:6378137,rf:298.257,ellipseName:"MERIT 1983"},n.SGS85={a:6378136,rf:298.257,ellipseName:"Soviet Geodetic System 85"},n.GRS80={a:6378137,rf:298.257222101,ellipseName:"GRS 1980(IUGG, 1980)"},n.IAU76={a:6378140,rf:298.257,ellipseName:"IAU 1976"},n.airy={a:6377563.396,b:6356256.91,ellipseName:"Airy 1830"},n.APL4={a:6378137,rf:298.25,ellipseName:"Appl. Physics. 1965"},n.NWL9D={a:6378145,rf:298.25,ellipseName:"Naval Weapons Lab., 1965"},n.mod_airy={a:6377340.189,b:6356034.446,ellipseName:"Modified Airy"},n.andrae={a:6377104.43,rf:300,ellipseName:"Andrae 1876 (Den., Iclnd.)"},n.aust_SA={a:6378160,rf:298.25,ellipseName:"Australian Natl & S. Amer. 1969"},n.GRS67={a:6378160,rf:298.247167427,ellipseName:"GRS 67(IUGG 1967)"},n.bessel={a:6377397.155,rf:299.1528128,ellipseName:"Bessel 1841"},n.bess_nam={a:6377483.865,rf:299.1528128,ellipseName:"Bessel 1841 (Namibia)"},n.clrk66={a:6378206.4,b:6356583.8,ellipseName:"Clarke 1866"},n.clrk80={a:6378249.145,rf:293.4663,ellipseName:"Clarke 1880 mod."},n.clrk58={a:6378293.645208759,rf:294.2606763692654,ellipseName:"Clarke 1858"},n.CPM={a:6375738.7,rf:334.29,ellipseName:"Comm. des Poids et Mesures 1799"},n.delmbr={a:6376428,rf:311.5,ellipseName:"Delambre 1810 (Belgium)"},n.engelis={a:6378136.05,rf:298.2566,ellipseName:"Engelis 1985"},n.evrst30={a:6377276.345,rf:300.8017,ellipseName:"Everest 1830"},n.evrst48={a:6377304.063,rf:300.8017,ellipseName:"Everest 1948"},n.evrst56={a:6377301.243,rf:300.8017,ellipseName:"Everest 1956"},n.evrst69={a:6377295.664,rf:300.8017,ellipseName:"Everest 1969"},n.evrstSS={a:6377298.556,rf:300.8017,ellipseName:"Everest (Sabah & Sarawak)"},n.fschr60={a:6378166,rf:298.3,ellipseName:"Fischer (Mercury Datum) 1960"},n.fschr60m={a:6378155,rf:298.3,ellipseName:"Fischer 1960"},n.fschr68={a:6378150,rf:298.3,ellipseName:"Fischer 1968"},n.helmert={a:6378200,rf:298.3,ellipseName:"Helmert 1906"},n.hough={a:6378270,rf:297,ellipseName:"Hough"},n.intl={a:6378388,rf:297,ellipseName:"International 1909 (Hayford)"},n.kaula={a:6378163,rf:298.24,ellipseName:"Kaula 1961"},n.lerch={a:6378139,rf:298.257,ellipseName:"Lerch 1979"},n.mprts={a:6397300,rf:191,ellipseName:"Maupertius 1738"},n.new_intl={a:6378157.5,b:6356772.2,ellipseName:"New International 1967"},n.plessis={a:6376523,rf:6355863,ellipseName:"Plessis 1817 (France)"},n.krass={a:6378245,rf:298.3,ellipseName:"Krassovsky, 1942"},n.SEasia={a:6378155,b:6356773.3205,ellipseName:"Southeast Asia"},n.walbeck={a:6376896,b:6355834.8467,ellipseName:"Walbeck"},n.WGS60={a:6378165,rf:298.3,ellipseName:"WGS 60"},n.WGS66={a:6378145,rf:298.25,ellipseName:"WGS 66"},n.WGS7={a:6378135,rf:298.26,ellipseName:"WGS 72"},n.WGS84={a:6378137,rf:298.257223563,ellipseName:"WGS 84"},n.sphere={a:6370997,b:6370997,ellipseName:"Normal Sphere (r=6370997)"}},{}],27:[function(e,t,n){n.greenwich=0,n.lisbon=-9.131906111111,n.paris=2.337229166667,n.bogota=-74.080916666667,n.madrid=-3.687938888889,n.rome=12.452333333333,n.bern=7.439583333333,n.jakarta=106.807719444444,n.ferro=-17.666666666667,n.brussels=4.367975,n.stockholm=18.058277777778,n.athens=23.7163375,n.oslo=10.722916666667},{}],28:[function(e,t){function n(e,t,n){var r;return Array.isArray(n)?(r=o(e,t,n),3===n.length?[r.x,r.y,r.z]:[r.x,r.y]):o(e,t,n)}function r(e){return e instanceof s?e:e.oProj?e.oProj:s(e)}function i(e,t,i){e=r(e);var s,o=!1;return"undefined"==typeof t?(t=e,e=u,o=!0):("undefined"!=typeof t.x||Array.isArray(t))&&(i=t,t=e,e=u,o=!0),t=r(t),i?n(e,t,i):(s={forward:function(r){return n(e,t,r)},inverse:function(r){return n(t,e,r)}},o&&(s.oProj=t),s)}var s=e("./Proj"),o=e("./transform"),u=s("WGS84");t.exports=i},{"./Proj":2,"./transform":64}],29:[function(e,t){var n=Math.PI/2,r=1,i=2,s=3,o=4,u=5,a=484813681109536e-20,f=1.0026,l=.3826834323650898,c=function(e){if(!(this instanceof c))return new c(e);if(this.datum_type=o,e){if(e.datumCode&&"none"===e.datumCode&&(this.datum_type=u),e.datum_params){for(var t=0;t<e.datum_params.length;t++)e.datum_params[t]=parseFloat(e.datum_params[t]);(0!==e.datum_params[0]||0!==e.datum_params[1]||0!==e.datum_params[2])&&(this.datum_type=r),e.datum_params.length>3&&(0!==e.datum_params[3]||0!==e.datum_params[4]||0!==e.datum_params[5]||0!==e.datum_params[6])&&(this.datum_type=i,e.datum_params[3]*=a,e.datum_params[4]*=a,e.datum_params[5]*=a,e.datum_params[6]=e.datum_params[6]/1e6+1)}this.datum_type=e.grids?s:this.datum_type,this.a=e.a,this.b=e.b,this.es=e.es,this.ep2=e.ep2,this.datum_params=e.datum_params,this.datum_type===s&&(this.grids=e.grids)}};c.prototype={compare_datums:function(e){return this.datum_type!==e.datum_type?!1:this.a!==e.a||Math.abs(this.es-e.es)>5e-11?!1:this.datum_type===r?this.datum_params[0]===e.datum_params[0]&&this.datum_params[1]===e.datum_params[1]&&this.datum_params[2]===e.datum_params[2]:this.datum_type===i?this.datum_params[0]===e.datum_params[0]&&this.datum_params[1]===e.datum_params[1]&&this.datum_params[2]===e.datum_params[2]&&this.datum_params[3]===e.datum_params[3]&&this.datum_params[4]===e.datum_params[4]&&this.datum_params[5]===e.datum_params[5]&&this.datum_params[6]===e.datum_params[6]:this.datum_type===s||e.datum_type===s?this.nadgrids===e.nadgrids:!0},geodetic_to_geocentric:function(e){var t,r,i,s,o,u,a,f=e.x,l=e.y,c=e.z?e.z:0,h=0;if(-n>l&&l>-1.001*n)l=-n;else if(l>n&&1.001*n>l)l=n;else if(-n>l||l>n)return null;return f>Math.PI&&(f-=2*Math.PI),o=Math.sin(l),a=Math.cos(l),u=o*o,s=this.a/Math.sqrt(1-this.es*u),t=(s+c)*a*Math.cos(f),r=(s+c)*a*Math.sin(f),i=(s*(1-this.es)+c)*o,e.x=t,e.y=r,e.z=i,h},geocentric_to_geodetic:function(e){var t,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b=1e-12,w=b*b,E=30,S=e.x,x=e.y,T=e.z?e.z:0;if(d=!1,t=Math.sqrt(S*S+x*x),r=Math.sqrt(S*S+x*x+T*T),t/this.a<b){if(d=!0,m=0,r/this.a<b)return g=n,void (y=-this.b)}else m=Math.atan2(x,S);i=T/r,s=t/r,o=1/Math.sqrt(1-this.es*(2-this.es)*s*s),f=s*(1-this.es)*o,l=i*o,v=0;do v++,a=this.a/Math.sqrt(1-this.es*l*l),y=t*f+T*l-a*(1-this.es*l*l),u=this.es*a/(a+y),o=1/Math.sqrt(1-u*(2-u)*s*s),c=s*(1-u)*o,h=i*o,p=h*f-c*l,f=c,l=h;while(p*p>w&&E>v);return g=Math.atan(h/Math.abs(c)),e.x=m,e.y=g,e.z=y,e},geocentric_to_geodetic_noniter:function(e){var t,r,i,s,o,u,a,c,h,p,d,v,m,g,y,b,w,E=e.x,S=e.y,x=e.z?e.z:0;if(E=parseFloat(E),S=parseFloat(S),x=parseFloat(x),w=!1,0!==E)t=Math.atan2(S,E);else if(S>0)t=n;else if(0>S)t=-n;else if(w=!0,t=0,x>0)r=n;else{if(!(0>x))return r=n,void (i=-this.b);r=-n}return o=E*E+S*S,s=Math.sqrt(o),u=x*f,c=Math.sqrt(u*u+o),p=u/c,v=s/c,d=p*p*p,a=x+this.b*this.ep2*d,b=s-this.a*this.es*v*v*v,h=Math.sqrt(a*a+b*b),m=a/h,g=b/h,y=this.a/Math.sqrt(1-this.es*m*m),i=g>=l?s/g-y:-l>=g?s/-g-y:x/m+y*(this.es-1),w===!1&&(r=Math.atan(m/g)),e.x=t,e.y=r,e.z=i,e},geocentric_to_wgs84:function(e){if(this.datum_type===r)e.x+=this.datum_params[0],e.y+=this.datum_params[1],e.z+=this.datum_params[2];else if(this.datum_type===i){var t=this.datum_params[0],n=this.datum_params[1],s=this.datum_params[2],o=this.datum_params[3],u=this.datum_params[4],a=this.datum_params[5],f=this.datum_params[6],l=f*(e.x-a*e.y+u*e.z)+t,c=f*(a*e.x+e.y-o*e.z)+n,h=f*(-u*e.x+o*e.y+e.z)+s;e.x=l,e.y=c,e.z=h}},geocentric_from_wgs84:function(e){if(this.datum_type===r)e.x-=this.datum_params[0],e.y-=this.datum_params[1],e.z-=this.datum_params[2];else if(this.datum_type===i){var t=this.datum_params[0],n=this.datum_params[1],s=this.datum_params[2],o=this.datum_params[3],u=this.datum_params[4],a=this.datum_params[5],f=this.datum_params[6],l=(e.x-t)/f,c=(e.y-n)/f,h=(e.z-s)/f;e.x=l+a*c-u*h,e.y=-a*l+c+o*h,e.z=u*l-o*c+h}}},t.exports=c},{}],30:[function(e,t){var n=1,r=2,i=3,s=5,o=6378137,u=.006694379990141316;t.exports=function(e,t,a){function l(e){return e===n||e===r}var p,v,m;if(e.compare_datums(t))return a;if(e.datum_type===s||t.datum_type===s)return a;var y=e.a,b=e.es,w=t.a,E=t.es,S=e.datum_type;if(S===i)if(0===this.apply_gridshift(e,0,a))e.a=o,e.es=u;else{if(!e.datum_params)return e.a=y,e.es=e.es,a;for(p=1,v=0,m=e.datum_params.length;m>v;v++)p*=e.datum_params[v];if(0===p)return e.a=y,e.es=e.es,a;S=e.datum_params.length>3?r:n}return t.datum_type===i&&(t.a=o,t.es=u),(e.es!==t.es||e.a!==t.a||l(S)||l(t.datum_type))&&(e.geodetic_to_geocentric(a),l(e.datum_type)&&e.geocentric_to_wgs84(a),l(t.datum_type)&&t.geocentric_from_wgs84(a),t.geocentric_to_geodetic(a)),t.datum_type===i&&this.apply_gridshift(t,1,a),e.a=y,e.es=b,t.a=w,t.es=E,a}},{}],31:[function(e,t){function n(e){var t=this;if(2===arguments.length){var r=arguments[1];n[e]="string"==typeof r?"+"===r[0]?i(arguments[1]):s(arguments[1]):r}else if(1===arguments.length){if(Array.isArray(e))return e.map(function(e){Array.isArray(e)?n.apply(t,e):n(e)});if("string"==typeof e){if(e in n)return n[e]}else"EPSG"in e?n["EPSG:"+e.EPSG]=e:"ESRI"in e?n["ESRI:"+e.ESRI]=e:"IAU2000"in e?n["IAU2000:"+e.IAU2000]=e:console.log(e);return}}var r=e("./global"),i=e("./projString"),s=e("./wkt");r(n),t.exports=n},{"./global":34,"./projString":37,"./wkt":65}],32:[function(e,t){var n=e("./constants/Datum"),r=e("./constants/Ellipsoid"),i=e("./extend"),s=e("./datum"),o=1e-10,u=.16666666666666666,a=.04722222222222222,f=.022156084656084655;t.exports=function(e){if(e.datumCode&&"none"!==e.datumCode){var t=n[e.datumCode];t&&(e.datum_params=t.towgs84?t.towgs84.split(","):null,e.ellps=t.ellipse,e.datumName=t.datumName?t.datumName:e.datumCode)}if(!e.a){var l=r[e.ellps]?r[e.ellps]:r.WGS84;i(e,l)}return e.rf&&!e.b&&(e.b=(1-1/e.rf)*e.a),(0===e.rf||Math.abs(e.a-e.b)<o)&&(e.sphere=!0,e.b=e.a),e.a2=e.a*e.a,e.b2=e.b*e.b,e.es=(e.a2-e.b2)/e.a2,e.e=Math.sqrt(e.es),e.R_A&&(e.a*=1-e.es*(u+e.es*(a+e.es*f)),e.a2=e.a*e.a,e.b2=e.b*e.b,e.es=0),e.ep2=(e.a2-e.b2)/e.b2,e.k0||(e.k0=1),e.axis||(e.axis="enu"),e.datum=s(e),e}},{"./constants/Datum":25,"./constants/Ellipsoid":26,"./datum":29,"./extend":33}],33:[function(e,t){t.exports=function(e,t){e=e||{};var n,r;if(!t)return e;for(r in t)n=t[r],void 0!==n&&(e[r]=n);return e}},{}],34:[function(e,t){t.exports=function(e){e("EPSG:4326","+title=WGS 84 (long/lat) +proj=longlat +ellps=WGS84 +datum=WGS84 +units=degrees"),e("EPSG:4269","+title=NAD83 (long/lat) +proj=longlat +a=6378137.0 +b=6356752.31414036 +ellps=GRS80 +datum=NAD83 +units=degrees"),e("EPSG:3857","+title=WGS 84 / Pseudo-Mercator +proj=merc +a=6378137 +b=6378137 +lat_ts=0.0 +lon_0=0.0 +x_0=0.0 +y_0=0 +k=1.0 +units=m +nadgrids=@null +no_defs"),e.WGS84=e["EPSG:4326"],e["EPSG:3785"]=e["EPSG:3857"],e.GOOGLE=e["EPSG:3857"],e["EPSG:900913"]=e["EPSG:3857"],e["EPSG:102113"]=e["EPSG:3857"]}},{}],35:[function(e,t){var n=e("./core");n.defaultDatum="WGS84",n.Proj=e("./Proj"),n.WGS84=new n.Proj("WGS84"),n.Point=e("./Point"),n.toPoint=e("./common/toPoint"),n.defs=e("./defs"),n.transform=e("./transform"),n.mgrs=e("mgrs"),n.version=e("../package.json").version,e("./includedProjections")(n),t.exports=n},{"../package.json":67,"./Point":1,"./Proj":2,"./common/toPoint":23,"./core":28,"./defs":31,"./includedProjections":"gWUPNW","./transform":64,mgrs:66}],36:[function(e,t){function n(e){return"string"==typeof e}function r(e){return e in u}function i(e){var t=["GEOGCS","GEOCCS","PROJCS","LOCAL_CS"];return t.reduce(function(t,n){return t+1+e.indexOf(n)},0)}function s(e){return"+"===e[0]}function o(e){return n(e)?r(e)?u[e]:i(e)?a(e):s(e)?f(e):void 0:e}var u=e("./defs"),a=e("./wkt"),f=e("./projString");t.exports=o},{"./defs":31,"./projString":37,"./wkt":65}],37:[function(e,t){var n=.017453292519943295,r=e("./constants/PrimeMeridian");t.exports=function(e){var t={},i={};e.split("+").map(function(e){return e.trim()}).filter(function(e){return e}).forEach(function(e){var t=e.split("=");t.push(!0),i[t[0].toLowerCase()]=t[1]});var s,o,u,a={proj:"projName",datum:"datumCode",rf:function(e){t.rf=parseFloat(e,10)},lat_0:function(e){t.lat0=e*n},lat_1:function(e){t.lat1=e*n},lat_2:function(e){t.lat2=e*n},lat_ts:function(e){t.lat_ts=e*n},lon_0:function(e){t.long0=e*n},lon_1:function(e){t.long1=e*n},lon_2:function(e){t.long2=e*n},alpha:function(e){t.alpha=parseFloat(e)*n},lonc:function(e){t.longc=e*n},x_0:function(e){t.x0=parseFloat(e,10)},y_0:function(e){t.y0=parseFloat(e,10)},k_0:function(e){t.k0=parseFloat(e,10)},k:function(e){t.k0=parseFloat(e,10)},r_a:function(){t.R_A=!0},zone:function(e){t.zone=parseInt(e,10)},south:function(){t.utmSouth=!0},towgs84:function(e){t.datum_params=e.split(",").map(function(e){return parseFloat(e,10)})},to_meter:function(e){t.to_meter=parseFloat(e,10)},from_greenwich:function(e){t.from_greenwich=e*n},pm:function(e){t.from_greenwich=(r[e]?r[e]:parseFloat(e,10))*n},nadgrids:function(e){"@null"===e?t.datumCode="none":t.nadgrids=e},axis:function(e){var n="ewnsud";3===e.length&&-1!==n.indexOf(e.substr(0,1))&&-1!==n.indexOf(e.substr(1,1))&&-1!==n.indexOf(e.substr(2,1))&&(t.axis=e)}};for(s in i)o=i[s],s in a?(u=a[s],"function"==typeof u?u(o):t[u]=o):t[s]=o;return"string"==typeof t.datumCode&&"WGS84"!==t.datumCode&&(t.datumCode=t.datumCode.toLowerCase()),t}},{"./constants/PrimeMeridian":27}],38:[function(e,t,n){function r(e,t){var n=o.length;return e.names?(o[n]=e,e.names.forEach(function(e){s[e.toLowerCase()]=n}),this):(console.log(t),!0)}var i=[e("./projections/merc"),e("./projections/longlat")],s={},o=[];n.add=r,n.get=function(e){if(!e)return!1;var t=e.toLowerCase();return"undefined"!=typeof s[t]&&o[s[t]]?o[s[t]]:void 0},n.start=function(){i.forEach(r)}},{"./projections/longlat":50,"./projections/merc":51}],39:[function(e,t,n){var r=1e-10,i=e("../common/msfnz"),s=e("../common/qsfnz"),o=e("../common/adjust_lon"),u=e("../common/asinz");n.init=function(){Math.abs(this.lat1+this.lat2)<r||(this.temp=this.b/this.a,this.es=1-Math.pow(this.temp,2),this.e3=Math.sqrt(this.es),this.sin_po=Math.sin(this.lat1),this.cos_po=Math.cos(this.lat1),this.t1=this.sin_po,this.con=this.sin_po,this.ms1=i(this.e3,this.sin_po,this.cos_po),this.qs1=s(this.e3,this.sin_po,this.cos_po),this.sin_po=Math.sin(this.lat2),this.cos_po=Math.cos(this.lat2),this.t2=this.sin_po,this.ms2=i(this.e3,this.sin_po,this.cos_po),this.qs2=s(this.e3,this.sin_po,this.cos_po),this.sin_po=Math.sin(this.lat0),this.cos_po=Math.cos(this.lat0),this.t3=this.sin_po,this.qs0=s(this.e3,this.sin_po,this.cos_po),this.ns0=Math.abs(this.lat1-this.lat2)>r?(this.ms1*this.ms1-this.ms2*this.ms2)/(this.qs2-this.qs1):this.con,this.c=this.ms1*this.ms1+this.ns0*this.qs1,this.rh=this.a*Math.sqrt(this.c-this.ns0*this.qs0)/this.ns0)},n.forward=function(e){var t=e.x,n=e.y;this.sin_phi=Math.sin(n),this.cos_phi=Math.cos(n);var r=s(this.e3,this.sin_phi,this.cos_phi),i=this.a*Math.sqrt(this.c-this.ns0*r)/this.ns0,u=this.ns0*o(t-this.long0),a=i*Math.sin(u)+this.x0,l=this.rh-i*Math.cos(u)+this.y0;return e.x=a,e.y=l,e},n.inverse=function(e){var t,n,r,i,s,u;return e.x-=this.x0,e.y=this.rh-e.y+this.y0,this.ns0>=0?(t=Math.sqrt(e.x*e.x+e.y*e.y),r=1):(t=-Math.sqrt(e.x*e.x+e.y*e.y),r=-1),i=0,0!==t&&(i=Math.atan2(r*e.x,r*e.y)),r=t*this.ns0/this.a,this.sphere?u=Math.asin((this.c-r*r)/(2*this.ns0)):(n=(this.c-r*r)/this.ns0,u=this.phi1z(this.e3,n)),s=o(i/this.ns0+this.long0),e.x=s,e.y=u,e},n.phi1z=function(e,t){var n,i,s,o,a,f=u(.5*t);if(r>e)return f;for(var l=e*e,c=1;25>=c;c++)if(n=Math.sin(f),i=Math.cos(f),s=e*n,o=1-s*s,a=.5*o*o/i*(t/(1-l)-n/o+.5/e*Math.log((1-s)/(1+s))),f+=a,Math.abs(a)<=1e-7)return f;return null},n.names=["Albers_Conic_Equal_Area","Albers","aea"]},{"../common/adjust_lon":5,"../common/asinz":6,"../common/msfnz":15,"../common/qsfnz":20}],40:[function(e,t,n){var r=e("../common/adjust_lon"),i=Math.PI/2,s=1e-10,o=e("../common/mlfn"),u=e("../common/e0fn"),a=e("../common/e1fn"),f=e("../common/e2fn"),l=e("../common/e3fn"),c=e("../common/gN"),h=e("../common/asinz"),p=e("../common/imlfn");n.init=function(){this.sin_p12=Math.sin(this.lat0),this.cos_p12=Math.cos(this.lat0)},n.forward=function(e){var t,n,h,p,v,m,y,b,w,E,S,x,T,N,C,L,A,O,M,_,D,P,H,B=e.x,F=e.y,I=Math.sin(e.y),q=Math.cos(e.y),R=r(B-this.long0);return this.sphere?Math.abs(this.sin_p12-1)<=s?(e.x=this.x0+this.a*(i-F)*Math.sin(R),e.y=this.y0-this.a*(i-F)*Math.cos(R),e):Math.abs(this.sin_p12+1)<=s?(e.x=this.x0+this.a*(i+F)*Math.sin(R),e.y=this.y0+this.a*(i+F)*Math.cos(R),e):(O=this.sin_p12*I+this.cos_p12*q*Math.cos(R),L=Math.acos(O),A=L/Math.sin(L),e.x=this.x0+this.a*A*q*Math.sin(R),e.y=this.y0+this.a*A*(this.cos_p12*I-this.sin_p12*q*Math.cos(R)),e):(t=u(this.es),n=a(this.es),h=f(this.es),p=l(this.es),Math.abs(this.sin_p12-1)<=s?(v=this.a*o(t,n,h,p,i),m=this.a*o(t,n,h,p,F),e.x=this.x0+(v-m)*Math.sin(R),e.y=this.y0-(v-m)*Math.cos(R),e):Math.abs(this.sin_p12+1)<=s?(v=this.a*o(t,n,h,p,i),m=this.a*o(t,n,h,p,F),e.x=this.x0+(v+m)*Math.sin(R),e.y=this.y0+(v+m)*Math.cos(R),e):(y=I/q,b=c(this.a,this.e,this.sin_p12),w=c(this.a,this.e,I),E=Math.atan((1-this.es)*y+this.es*b*this.sin_p12/(w*q)),S=Math.atan2(Math.sin(R),this.cos_p12*Math.tan(E)-this.sin_p12*Math.cos(R)),M=0===S?Math.asin(this.cos_p12*Math.sin(E)-this.sin_p12*Math.cos(E)):Math.abs(Math.abs(S)-Math.PI)<=s?-Math.asin(this.cos_p12*Math.sin(E)-this.sin_p12*Math.cos(E)):Math.asin(Math.sin(R)*Math.cos(E)/Math.sin(S)),x=this.e*this.sin_p12/Math.sqrt(1-this.es),T=this.e*this.cos_p12*Math.cos(S)/Math.sqrt(1-this.es),N=x*T,C=T*T,_=M*M,D=_*M,P=D*M,H=P*M,L=b*M*(1-_*C*(1-C)/6+D/8*N*(1-2*C)+P/120*(C*(4-7*C)-3*x*x*(1-7*C))-H/48*N),e.x=this.x0+L*Math.sin(S),e.y=this.y0+L*Math.cos(S),e))},n.inverse=function(e){e.x-=this.x0,e.y-=this.y0;var t,n,v,y,b,w,E,S,x,T,N,C,L,A,O,M,_,D,P,H,B,F,I;if(this.sphere){if(t=Math.sqrt(e.x*e.x+e.y*e.y),t>2*i*this.a)return;return n=t/this.a,v=Math.sin(n),y=Math.cos(n),b=this.long0,Math.abs(t)<=s?w=this.lat0:(w=h(y*this.sin_p12+e.y*v*this.cos_p12/t),E=Math.abs(this.lat0)-i,b=r(Math.abs(E)<=s?this.lat0>=0?this.long0+Math.atan2(e.x,-e.y):this.long0-Math.atan2(-e.x,e.y):this.long0+Math.atan2(e.x*v,t*this.cos_p12*y-e.y*this.sin_p12*v))),e.x=b,e.y=w,e}return S=u(this.es),x=a(this.es),T=f(this.es),N=l(this.es),Math.abs(this.sin_p12-1)<=s?(C=this.a*o(S,x,T,N,i),t=Math.sqrt(e.x*e.x+e.y*e.y),L=C-t,w=p(L/this.a,S,x,T,N),b=r(this.long0+Math.atan2(e.x,-1*e.y)),e.x=b,e.y=w,e):Math.abs(this.sin_p12+1)<=s?(C=this.a*o(S,x,T,N,i),t=Math.sqrt(e.x*e.x+e.y*e.y),L=t-C,w=p(L/this.a,S,x,T,N),b=r(this.long0+Math.atan2(e.x,e.y)),e.x=b,e.y=w,e):(t=Math.sqrt(e.x*e.x+e.y*e.y),M=Math.atan2(e.x,e.y),A=c(this.a,this.e,this.sin_p12),_=Math.cos(M),D=this.e*this.cos_p12*_,P=-D*D/(1-this.es),H=3*this.es*(1-P)*this.sin_p12*this.cos_p12*_/(1-this.es),B=t/A,F=B-P*(1+P)*Math.pow(B,3)/6-H*(1+3*P)*Math.pow(B,4)/24,I=1-P*F*F/2-B*F*F*F/6,O=Math.asin(this.sin_p12*Math.cos(F)+this.cos_p12*Math.sin(F)*_),b=r(this.long0+Math.asin(Math.sin(M)*Math.sin(F)/Math.cos(O))),w=Math.atan((1-this.es*I*this.sin_p12/Math.sin(O))*Math.tan(O)/(1-this.es)),e.x=b,e.y=w,e)},n.names=["Azimuthal_Equidistant","aeqd"]},{"../common/adjust_lon":5,"../common/asinz":6,"../common/e0fn":7,"../common/e1fn":8,"../common/e2fn":9,"../common/e3fn":10,"../common/gN":11,"../common/imlfn":12,"../common/mlfn":14}],41:[function(e,t,n){var r=e("../common/mlfn"),i=e("../common/e0fn"),s=e("../common/e1fn"),o=e("../common/e2fn"),u=e("../common/e3fn"),a=e("../common/gN"),f=e("../common/adjust_lon"),l=e("../common/adjust_lat"),c=e("../common/imlfn"),h=Math.PI/2,p=1e-10;n.init=function(){this.sphere||(this.e0=i(this.es),this.e1=s(this.es),this.e2=o(this.es),this.e3=u(this.es),this.ml0=this.a*r(this.e0,this.e1,this.e2,this.e3,this.lat0))},n.forward=function(e){var t,n,i=e.x,s=e.y;if(i=f(i-this.long0),this.sphere)t=this.a*Math.asin(Math.cos(s)*Math.sin(i)),n=this.a*(Math.atan2(Math.tan(s),Math.cos(i))-this.lat0);else{var o=Math.sin(s),u=Math.cos(s),l=a(this.a,this.e,o),c=Math.tan(s)*Math.tan(s),h=i*Math.cos(s),p=h*h,v=this.es*u*u/(1-this.es),m=this.a*r(this.e0,this.e1,this.e2,this.e3,s);t=l*h*(1-p*c*(1/6-(8-c+8*v)*p/120)),n=m-this.ml0+l*o/u*p*(.5+(5-c+6*v)*p/24)}return e.x=t+this.x0,e.y=n+this.y0,e},n.inverse=function(e){e.x-=this.x0,e.y-=this.y0;var t,n,r=e.x/this.a,i=e.y/this.a;if(this.sphere){var s=i+this.lat0;t=Math.asin(Math.sin(s)*Math.cos(r)),n=Math.atan2(Math.tan(r),Math.cos(s))}else{var o=this.ml0/this.a+i,u=c(o,this.e0,this.e1,this.e2,this.e3);if(Math.abs(Math.abs(u)-h)<=p)return e.x=this.long0,e.y=h,0>i&&(e.y*=-1),e;var d=a(this.a,this.e,Math.sin(u)),v=d*d*d/this.a/this.a*(1-this.es),g=Math.pow(Math.tan(u),2),y=r*this.a/d,b=y*y;t=u-d*Math.tan(u)/v*y*y*(.5-(1+3*g)*y*y/24),n=y*(1-b*(g/3+(1+3*g)*g*b/15))/Math.cos(u)}return e.x=f(n+this.long0),e.y=l(t),e},n.names=["Cassini","Cassini_Soldner","cass"]},{"../common/adjust_lat":4,"../common/adjust_lon":5,"../common/e0fn":7,"../common/e1fn":8,"../common/e2fn":9,"../common/e3fn":10,"../common/gN":11,"../common/imlfn":12,"../common/mlfn":14}],42:[function(e,t,n){var r=e("../common/adjust_lon"),i=e("../common/qsfnz"),s=e("../common/msfnz"),o=e("../common/iqsfnz");n.init=function(){this.sphere||(this.k0=s(this.e,Math.sin(this.lat_ts),Math.cos(this.lat_ts)))},n.forward=function(e){var t,n,s=e.x,o=e.y,u=r(s-this.long0);if(this.sphere)t=this.x0+this.a*u*Math.cos(this.lat_ts),n=this.y0+this.a*Math.sin(o)/Math.cos(this.lat_ts);else{var a=i(this.e,Math.sin(o));t=this.x0+this.a*this.k0*u,n=this.y0+this.a*a*.5/this.k0}return e.x=t,e.y=n,e},n.inverse=function(e){e.x-=this.x0,e.y-=this.y0;var t,n;return this.sphere?(t=r(this.long0+e.x/this.a/Math.cos(this.lat_ts)),n=Math.asin(e.y/this.a*Math.cos(this.lat_ts))):(n=o(this.e,2*e.y*this.k0/this.a),t=r(this.long0+e.x/(this.a*this.k0))),e.x=t,e.y=n,e},n.names=["cea"]},{"../common/adjust_lon":5,"../common/iqsfnz":13,"../common/msfnz":15,"../common/qsfnz":20}],43:[function(e,t,n){var r=e("../common/adjust_lon"),i=e("../common/adjust_lat");n.init=function(){this.x0=this.x0||0,this.y0=this.y0||0,this.lat0=this.lat0||0,this.long0=this.long0||0,this.lat_ts=this.lat_ts||0,this.title=this.title||"Equidistant Cylindrical (Plate Carre)",this.rc=Math.cos(this.lat_ts)},n.forward=function(e){var t=e.x,n=e.y,s=r(t-this.long0),o=i(n-this.lat0);return e.x=this.x0+this.a*s*this.rc,e.y=this.y0+this.a*o,e},n.inverse=function(e){var t=e.x,n=e.y;return e.x=r(this.long0+(t-this.x0)/(this.a*this.rc)),e.y=i(this.lat0+(n-this.y0)/this.a),e},n.names=["Equirectangular","Equidistant_Cylindrical","eqc"]},{"../common/adjust_lat":4,"../common/adjust_lon":5}],44:[function(e,t,n){var r=e("../common/e0fn"),i=e("../common/e1fn"),s=e("../common/e2fn"),o=e("../common/e3fn"),u=e("../common/msfnz"),a=e("../common/mlfn"),f=e("../common/adjust_lon"),l=e("../common/adjust_lat"),c=e("../common/imlfn"),h=1e-10;n.init=function(){Math.abs(this.lat1+this.lat2)<h||(this.lat2=this.lat2||this.lat1,this.temp=this.b/this.a,this.es=1-Math.pow(this.temp,2),this.e=Math.sqrt(this.es),this.e0=r(this.es),this.e1=i(this.es),this.e2=s(this.es),this.e3=o(this.es),this.sinphi=Math.sin(this.lat1),this.cosphi=Math.cos(this.lat1),this.ms1=u(this.e,this.sinphi,this.cosphi),this.ml1=a(this.e0,this.e1,this.e2,this.e3,this.lat1),Math.abs(this.lat1-this.lat2)<h?this.ns=this.sinphi:(this.sinphi=Math.sin(this.lat2),this.cosphi=Math.cos(this.lat2),this.ms2=u(this.e,this.sinphi,this.cosphi),this.ml2=a(this.e0,this.e1,this.e2,this.e3,this.lat2),this.ns=(this.ms1-this.ms2)/(this.ml2-this.ml1)),this.g=this.ml1+this.ms1/this.ns,this.ml0=a(this.e0,this.e1,this.e2,this.e3,this.lat0),this.rh=this.a*(this.g-this.ml0))},n.forward=function(e){var t,n=e.x,r=e.y;if(this.sphere)t=this.a*(this.g-r);else{var i=a(this.e0,this.e1,this.e2,this.e3,r);t=this.a*(this.g-i)}var s=this.ns*f(n-this.long0),o=this.x0+t*Math.sin(s),u=this.y0+this.rh-t*Math.cos(s);return e.x=o,e.y=u,e},n.inverse=function(e){e.x-=this.x0,e.y=this.rh-e.y+this.y0;var t,n,r,i;this.ns>=0?(n=Math.sqrt(e.x*e.x+e.y*e.y),t=1):(n=-Math.sqrt(e.x*e.x+e.y*e.y),t=-1);var s=0;if(0!==n&&(s=Math.atan2(t*e.x,t*e.y)),this.sphere)return i=f(this.long0+s/this.ns),r=l(this.g-n/this.a),e.x=i,e.y=r,e;var o=this.g-n/this.a;return r=c(o,this.e0,this.e1,this.e2,this.e3),i=f(this.long0+s/this.ns),e.x=i,e.y=r,e},n.names=["Equidistant_Conic","eqdc"]},{"../common/adjust_lat":4,"../common/adjust_lon":5,"../common/e0fn":7,"../common/e1fn":8,"../common/e2fn":9,"../common/e3fn":10,"../common/imlfn":12,"../common/mlfn":14,"../common/msfnz":15}],45:[function(e,t,n){var r=Math.PI/4,i=e("../common/srat"),s=Math.PI/2,o=20;n.init=function(){var e=Math.sin(this.lat0),t=Math.cos(this.lat0);t*=t,this.rc=Math.sqrt(1-this.es)/(1-this.es*e*e),this.C=Math.sqrt(1+this.es*t*t/(1-this.es)),this.phic0=Math.asin(e/this.C),this.ratexp=.5*this.C*this.e,this.K=Math.tan(.5*this.phic0+r)/(Math.pow(Math.tan(.5*this.lat0+r),this.C)*i(this.e*e,this.ratexp))},n.forward=function(e){var t=e.x,n=e.y;return e.y=2*Math.atan(this.K*Math.pow(Math.tan(.5*n+r),this.C)*i(this.e*Math.sin(n),this.ratexp))-s,e.x=this.C*t,e},n.inverse=function(e){for(var t=1e-14,n=e.x/this.C,u=e.y,a=Math.pow(Math.tan(.5*u+r)/this.K,1/this.C),l=o;l>0&&(u=2*Math.atan(a*i(this.e*Math.sin(e.y),-0.5*this.e))-s,!(Math.abs(u-e.y)<t));--l)e.y=u;return l?(e.x=n,e.y=u,e):null},n.names=["gauss"]},{"../common/srat":22}],46:[function(e,t,n){var r=e("../common/adjust_lon"),i=1e-10,s=e("../common/asinz");n.init=function(){this.sin_p14=Math.sin(this.lat0),this.cos_p14=Math.cos(this.lat0),this.infinity_dist=1e3*this.a,this.rc=1},n.forward=function(e){var t,n,s,o,u,a,f,l,c=e.x,h=e.y;return s=r(c-this.long0),t=Math.sin(h),n=Math.cos(h),o=Math.cos(s),a=this.sin_p14*t+this.cos_p14*n*o,u=1,a>0||Math.abs(a)<=i?(f=this.x0+this.a*u*n*Math.sin(s)/a,l=this.y0+this.a*u*(this.cos_p14*t-this.sin_p14*n*o)/a):(f=this.x0+this.infinity_dist*n*Math.sin(s),l=this.y0+this.infinity_dist*(this.cos_p14*t-this.sin_p14*n*o)),e.x=f,e.y=l,e},n.inverse=function(e){var t,n,i,o,u,a;return e.x=(e.x-this.x0)/this.a,e.y=(e.y-this.y0)/this.a,e.x/=this.k0,e.y/=this.k0,(t=Math.sqrt(e.x*e.x+e.y*e.y))?(o=Math.atan2(t,this.rc),n=Math.sin(o),i=Math.cos(o),a=s(i*this.sin_p14+e.y*n*this.cos_p14/t),u=Math.atan2(e.x*n,t*this.cos_p14*i-e.y*this.sin_p14*n),u=r(this.long0+u)):(a=this.phic0,u=0),e.x=u,e.y=a,e},n.names=["gnom"]},{"../common/adjust_lon":5,"../common/asinz":6}],47:[function(e,t,n){var r=e("../common/adjust_lon");n.init=function(){this.a=6377397.155,this.es=.006674372230614,this.e=Math.sqrt(this.es),this.lat0||(this.lat0=.863937979737193),this.long0||(this.long0=.4334234309119251),this.k0||(this.k0=.9999),this.s45=.785398163397448,this.s90=2*this.s45,this.fi0=this.lat0,this.e2=this.es,this.e=Math.sqrt(this.e2),this.alfa=Math.sqrt(1+this.e2*Math.pow(Math.cos(this.fi0),4)/(1-this.e2)),this.uq=1.04216856380474,this.u0=Math.asin(Math.sin(this.fi0)/this.alfa),this.g=Math.pow((1+this.e*Math.sin(this.fi0))/(1-this.e*Math.sin(this.fi0)),this.alfa*this.e/2),this.k=Math.tan(this.u0/2+this.s45)/Math.pow(Math.tan(this.fi0/2+this.s45),this.alfa)*this.g,this.k1=this.k0,this.n0=this.a*Math.sqrt(1-this.e2)/(1-this.e2*Math.pow(Math.sin(this.fi0),2)),this.s0=1.37008346281555,this.n=Math.sin(this.s0),this.ro0=this.k1*this.n0/Math.tan(this.s0),this.ad=this.s90-this.uq},n.forward=function(e){var t,n,i,s,o,u,a,f=e.x,l=e.y,c=r(f-this.long0);return t=Math.pow((1+this.e*Math.sin(l))/(1-this.e*Math.sin(l)),this.alfa*this.e/2),n=2*(Math.atan(this.k*Math.pow(Math.tan(l/2+this.s45),this.alfa)/t)-this.s45),i=-c*this.alfa,s=Math.asin(Math.cos(this.ad)*Math.sin(n)+Math.sin(this.ad)*Math.cos(n)*Math.cos(i)),o=Math.asin(Math.cos(n)*Math.sin(i)/Math.cos(s)),u=this.n*o,a=this.ro0*Math.pow(Math.tan(this.s0/2+this.s45),this.n)/Math.pow(Math.tan(s/2+this.s45),this.n),e.y=a*Math.cos(u)/1,e.x=a*Math.sin(u)/1,this.czech||(e.y*=-1,e.x*=-1),e},n.inverse=function(e){var t,n,r,i,s,o,u,a,f=e.x;e.x=e.y,e.y=f,this.czech||(e.y*=-1,e.x*=-1),o=Math.sqrt(e.x*e.x+e.y*e.y),s=Math.atan2(e.y,e.x),i=s/Math.sin(this.s0),r=2*(Math.atan(Math.pow(this.ro0/o,1/this.n)*Math.tan(this.s0/2+this.s45))-this.s45),t=Math.asin(Math.cos(this.ad)*Math.sin(r)-Math.sin(this.ad)*Math.cos(r)*Math.cos(i)),n=Math.asin(Math.cos(r)*Math.sin(i)/Math.cos(t)),e.x=this.long0-n/this.alfa,u=t,a=0;var l=0;do e.y=2*(Math.atan(Math.pow(this.k,-1/this.alfa)*Math.pow(Math.tan(t/2+this.s45),1/this.alfa)*Math.pow((1+this.e*Math.sin(u))/(1-this.e*Math.sin(u)),this.e/2))-this.s45),Math.abs(u-e.y)<1e-10&&(a=1),u=e.y,l+=1;while(0===a&&15>l);return l>=15?null:e},n.names=["Krovak","krovak"]},{"../common/adjust_lon":5}],48:[function(e,t,n){var r=Math.PI/2,i=Math.PI/4,s=1e-10,o=e("../common/qsfnz"),u=e("../common/adjust_lon");n.S_POLE=1,n.N_POLE=2,n.EQUIT=3,n.OBLIQ=4,n.init=function(){var e=Math.abs(this.lat0);if(this.mode=Math.abs(e-r)<s?this.lat0<0?this.S_POLE:this.N_POLE:Math.abs(e)<s?this.EQUIT:this.OBLIQ,this.es>0){var t;switch(this.qp=o(this.e,1),this.mmf=.5/(1-this.es),this.apa=this.authset(this.es),this.mode){case this.N_POLE:this.dd=1;break;case this.S_POLE:this.dd=1;break;case this.EQUIT:this.rq=Math.sqrt(.5*this.qp),this.dd=1/this.rq,this.xmf=1,this.ymf=.5*this.qp;break;case this.OBLIQ:this.rq=Math.sqrt(.5*this.qp),t=Math.sin(this.lat0),this.sinb1=o(this.e,t)/this.qp,this.cosb1=Math.sqrt(1-this.sinb1*this.sinb1),this.dd=Math.cos(this.lat0)/(Math.sqrt(1-this.es*t*t)*this.rq*this.cosb1),this.ymf=(this.xmf=this.rq)/this.dd,this.xmf*=this.dd}}else this.mode===this.OBLIQ&&(this.sinph0=Math.sin(this.lat0),this.cosph0=Math.cos(this.lat0))},n.forward=function(e){var t,n,a,l,c,p,v,m,y,b,w=e.x,E=e.y;if(w=u(w-this.long0),this.sphere){if(c=Math.sin(E),b=Math.cos(E),a=Math.cos(w),this.mode===this.OBLIQ||this.mode===this.EQUIT){if(n=this.mode===this.EQUIT?1+b*a:1+this.sinph0*c+this.cosph0*b*a,s>=n)return null;n=Math.sqrt(2/n),t=n*b*Math.sin(w),n*=this.mode===this.EQUIT?c:this.cosph0*c-this.sinph0*b*a}else if(this.mode===this.N_POLE||this.mode===this.S_POLE){if(this.mode===this.N_POLE&&(a=-a),Math.abs(E+this.phi0)<s)return null;n=i-.5*E,n=2*(this.mode===this.S_POLE?Math.cos(n):Math.sin(n)),t=n*Math.sin(w),n*=a}}else{switch(v=0,m=0,y=0,a=Math.cos(w),l=Math.sin(w),c=Math.sin(E),p=o(this.e,c),(this.mode===this.OBLIQ||this.mode===this.EQUIT)&&(v=p/this.qp,m=Math.sqrt(1-v*v)),this.mode){case this.OBLIQ:y=1+this.sinb1*v+this.cosb1*m*a;break;case this.EQUIT:y=1+m*a;break;case this.N_POLE:y=r+E,p=this.qp-p;break;case this.S_POLE:y=E-r,p=this.qp+p}if(Math.abs(y)<s)return null;switch(this.mode){case this.OBLIQ:case this.EQUIT:y=Math.sqrt(2/y),n=this.mode===this.OBLIQ?this.ymf*y*(this.cosb1*v-this.sinb1*m*a):(y=Math.sqrt(2/(1+m*a)))*v*this.ymf,t=this.xmf*y*m*l;break;case this.N_POLE:case this.S_POLE:p>=0?(t=(y=Math.sqrt(p))*l,n=a*(this.mode===this.S_POLE?y:-y)):t=n=0}}return e.x=this.a*t+this.x0,e.y=this.a*n+this.y0,e},n.inverse=function(e){e.x-=this.x0,e.y-=this.y0;var t,n,i,o,a,l,c,p=e.x/this.a,v=e.y/this.a;if(this.sphere){var m,g=0,y=0;if(m=Math.sqrt(p*p+v*v),n=.5*m,n>1)return null;switch(n=2*Math.asin(n),(this.mode===this.OBLIQ||this.mode===this.EQUIT)&&(y=Math.sin(n),g=Math.cos(n)),this.mode){case this.EQUIT:n=Math.abs(m)<=s?0:Math.asin(v*y/m),p*=y,v=g*m;break;case this.OBLIQ:n=Math.abs(m)<=s?this.phi0:Math.asin(g*this.sinph0+v*y*this.cosph0/m),p*=y*this.cosph0,v=(g-Math.sin(n)*this.sinph0)*m;break;case this.N_POLE:v=-v,n=r-n;break;case this.S_POLE:n-=r}t=0!==v||this.mode!==this.EQUIT&&this.mode!==this.OBLIQ?Math.atan2(p,v):0}else{if(c=0,this.mode===this.OBLIQ||this.mode===this.EQUIT){if(p/=this.dd,v*=this.dd,l=Math.sqrt(p*p+v*v),s>l)return e.x=0,e.y=this.phi0,e;o=2*Math.asin(.5*l/this.rq),i=Math.cos(o),p*=o=Math.sin(o),this.mode===this.OBLIQ?(c=i*this.sinb1+v*o*this.cosb1/l,a=this.qp*c,v=l*this.cosb1*i-v*this.sinb1*o):(c=v*o/l,a=this.qp*c,v=l*i)}else if(this.mode===this.N_POLE||this.mode===this.S_POLE){if(this.mode===this.N_POLE&&(v=-v),a=p*p+v*v,!a)return e.x=0,e.y=this.phi0,e;c=1-a/this.qp,this.mode===this.S_POLE&&(c=-c)}t=Math.atan2(p,v),n=this.authlat(Math.asin(c),this.apa)}return e.x=u(this.long0+t),e.y=n,e},n.P00=.3333333333333333,n.P01=.17222222222222222,n.P02=.10257936507936508,n.P10=.06388888888888888,n.P11=.0664021164021164,n.P20=.016415012942191543,n.authset=function(e){var t,n=[];return n[0]=e*this.P00,t=e*e,n[0]+=t*this.P01,n[1]=t*this.P10,t*=e,n[0]+=t*this.P02,n[1]+=t*this.P11,n[2]=t*this.P20,n},n.authlat=function(e,t){var n=e+e;return e+t[0]*Math.sin(n)+t[1]*Math.sin(n+n)+t[2]*Math.sin(n+n+n)},n.names=["Lambert Azimuthal Equal Area","Lambert_Azimuthal_Equal_Area","laea"]},{"../common/adjust_lon":5,"../common/qsfnz":20}],49:[function(e,t,n){var r=1e-10,i=e("../common/msfnz"),s=e("../common/tsfnz"),o=Math.PI/2,u=e("../common/sign"),a=e("../common/adjust_lon"),f=e("../common/phi2z");n.init=function(){if(this.lat2||(this.lat2=this.lat1),this.k0||(this.k0=1),this.x0=this.x0||0,this.y0=this.y0||0,!(Math.abs(this.lat1+this.lat2)<r)){var e=this.b/this.a;this.e=Math.sqrt(1-e*e);var t=Math.sin(this.lat1),n=Math.cos(this.lat1),o=i(this.e,t,n),u=s(this.e,this.lat1,t),a=Math.sin(this.lat2),f=Math.cos(this.lat2),l=i(this.e,a,f),c=s(this.e,this.lat2,a),h=s(this.e,this.lat0,Math.sin(this.lat0));this.ns=Math.abs(this.lat1-this.lat2)>r?Math.log(o/l)/Math.log(u/c):t,isNaN(this.ns)&&(this.ns=t),this.f0=o/(this.ns*Math.pow(u,this.ns)),this.rh=this.a*this.f0*Math.pow(h,this.ns),this.title||(this.title="Lambert Conformal Conic")}},n.forward=function(e){var t=e.x,n=e.y;Math.abs(2*Math.abs(n)-Math.PI)<=r&&(n=u(n)*(o-2*r));var i,f,l=Math.abs(Math.abs(n)-o);if(l>r)i=s(this.e,n,Math.sin(n)),f=this.a*this.f0*Math.pow(i,this.ns);else{if(l=n*this.ns,0>=l)return null;f=0}var c=this.ns*a(t-this.long0);return e.x=this.k0*f*Math.sin(c)+this.x0,e.y=this.k0*(this.rh-f*Math.cos(c))+this.y0,e},n.inverse=function(e){var t,n,r,i,s,u=(e.x-this.x0)/this.k0,l=this.rh-(e.y-this.y0)/this.k0;this.ns>0?(t=Math.sqrt(u*u+l*l),n=1):(t=-Math.sqrt(u*u+l*l),n=-1);var c=0;if(0!==t&&(c=Math.atan2(n*u,n*l)),0!==t||this.ns>0){if(n=1/this.ns,r=Math.pow(t/(this.a*this.f0),n),i=f(this.e,r),-9999===i)return null}else i=-o;return s=a(c/this.ns+this.long0),e.x=s,e.y=i,e},n.names=["Lambert Tangential Conformal Conic Projection","Lambert_Conformal_Conic","Lambert_Conformal_Conic_2SP","lcc"]},{"../common/adjust_lon":5,"../common/msfnz":15,"../common/phi2z":16,"../common/sign":21,"../common/tsfnz":24}],50:[function(e,t,n){function r(e){return e}n.init=function(){},n.forward=r,n.inverse=r,n.names=["longlat","identity"]},{}],51:[function(e,t,n){var r=e("../common/msfnz"),i=Math.PI/2,s=1e-10,o=57.29577951308232,u=e("../common/adjust_lon"),a=Math.PI/4,f=e("../common/tsfnz"),l=e("../common/phi2z");n.init=function(){var e=this.b/this.a;this.es=1-e*e,"x0"in this||(this.x0=0),"y0"in this||(this.y0=0),this.e=Math.sqrt(this.es),this.lat_ts?this.k0=this.sphere?Math.cos(this.lat_ts):r(this.e,Math.sin(this.lat_ts),Math.cos(this.lat_ts)):this.k0||(this.k0=this.k?this.k:1)},n.forward=function(e){var t=e.x,n=e.y;if(n*o>90&&-90>n*o&&t*o>180&&-180>t*o)return null;var r,l;if(Math.abs(Math.abs(n)-i)<=s)return null;if(this.sphere)r=this.x0+this.a*this.k0*u(t-this.long0),l=this.y0+this.a*this.k0*Math.log(Math.tan(a+.5*n));else{var c=Math.sin(n),p=f(this.e,n,c);r=this.x0+this.a*this.k0*u(t-this.long0),l=this.y0-this.a*this.k0*Math.log(p)}return e.x=r,e.y=l,e},n.inverse=function(e){var t,n,r=e.x-this.x0,s=e.y-this.y0;if(this.sphere)n=i-2*Math.atan(Math.exp(-s/(this.a*this.k0)));else{var o=Math.exp(-s/(this.a*this.k0));if(n=l(this.e,o),-9999===n)return null}return t=u(this.long0+r/(this.a*this.k0)),e.x=t,e.y=n,e},n.names=["Mercator","Popular Visualisation Pseudo Mercator","Mercator_1SP","Mercator_Auxiliary_Sphere","merc"]},{"../common/adjust_lon":5,"../common/msfnz":15,"../common/phi2z":16,"../common/tsfnz":24}],52:[function(e,t,n){var r=e("../common/adjust_lon");n.init=function(){},n.forward=function(e){var t=e.x,n=e.y,i=r(t-this.long0),s=this.x0+this.a*i,o=this.y0+this.a*Math.log(Math.tan(Math.PI/4+n/2.5))*1.25;return e.x=s,e.y=o,e},n.inverse=function(e){e.x-=this.x0,e.y-=this.y0;var t=r(this.long0+e.x/this.a),n=2.5*(Math.atan(Math.exp(.8*e.y/this.a))-Math.PI/4);return e.x=t,e.y=n,e},n.names=["Miller_Cylindrical","mill"]},{"../common/adjust_lon":5}],53:[function(e,t,n){var r=e("../common/adjust_lon"),i=1e-10;n.init=function(){},n.forward=function(e){for(var t=e.x,n=e.y,s=r(t-this.long0),o=n,u=Math.PI*Math.sin(n),a=0;!0;a++){var f=-(o+Math.sin(o)-u)/(1+Math.cos(o));if(o+=f,Math.abs(f)<i)break}o/=2,Math.PI/2-Math.abs(n)<i&&(s=0);var l=.900316316158*this.a*s*Math.cos(o)+this.x0,c=1.4142135623731*this.a*Math.sin(o)+this.y0;return e.x=l,e.y=c,e},n.inverse=function(e){var t,n;e.x-=this.x0,e.y-=this.y0,n=e.y/(1.4142135623731*this.a),Math.abs(n)>.999999999999&&(n=.999999999999),t=Math.asin(n);var i=r(this.long0+e.x/(.900316316158*this.a*Math.cos(t)));i<-Math.PI&&(i=-Math.PI),i>Math.PI&&(i=Math.PI),n=(2*t+Math.sin(2*t))/Math.PI,Math.abs(n)>1&&(n=1);var s=Math.asin(n);return e.x=i,e.y=s,e},n.names=["Mollweide","moll"]},{"../common/adjust_lon":5}],54:[function(e,t,n){var r=484813681109536e-20;n.iterations=1,n.init=function(){this.A=[],this.A[1]=.6399175073,this.A[2]=-0.1358797613,this.A[3]=.063294409,this.A[4]=-0.02526853,this.A[5]=.0117879,this.A[6]=-0.0055161,this.A[7]=.0026906,this.A[8]=-0.001333,this.A[9]=67e-5,this.A[10]=-0.00034,this.B_re=[],this.B_im=[],this.B_re[1]=.7557853228,this.B_im[1]=0,this.B_re[2]=.249204646,this.B_im[2]=.003371507,this.B_re[3]=-0.001541739,this.B_im[3]=.04105856,this.B_re[4]=-0.10162907,this.B_im[4]=.01727609,this.B_re[5]=-0.26623489,this.B_im[5]=-0.36249218,this.B_re[6]=-0.6870983,this.B_im[6]=-1.1651967,this.C_re=[],this.C_im=[],this.C_re[1]=1.3231270439,this.C_im[1]=0,this.C_re[2]=-0.577245789,this.C_im[2]=-0.007809598,this.C_re[3]=.508307513,this.C_im[3]=-0.112208952,this.C_re[4]=-0.15094762,this.C_im[4]=.18200602,this.C_re[5]=1.01418179,this.C_im[5]=1.64497696,this.C_re[6]=1.9660549,this.C_im[6]=2.5127645,this.D=[],this.D[1]=1.5627014243,this.D[2]=.5185406398,this.D[3]=-0.03333098,this.D[4]=-0.1052906,this.D[5]=-0.0368594,this.D[6]=.007317,this.D[7]=.0122,this.D[8]=.00394,this.D[9]=-0.0013},n.forward=function(e){var t,n=e.x,i=e.y,s=i-this.lat0,o=n-this.long0,u=s/r*1e-5,a=o,f=1,l=0;for(t=1;10>=t;t++)f*=u,l+=this.A[t]*f;var c,h,p=l,v=a,m=1,g=0,y=0,b=0;for(t=1;6>=t;t++)c=m*p-g*v,h=g*p+m*v,m=c,g=h,y=y+this.B_re[t]*m-this.B_im[t]*g,b=b+this.B_im[t]*m+this.B_re[t]*g;return e.x=b*this.a+this.x0,e.y=y*this.a+this.y0,e},n.inverse=function(e){var t,n,i,s=e.x,o=e.y,u=s-this.x0,a=o-this.y0,f=a/this.a,l=u/this.a,c=1,h=0,p=0,v=0;for(t=1;6>=t;t++)n=c*f-h*l,i=h*f+c*l,c=n,h=i,p=p+this.C_re[t]*c-this.C_im[t]*h,v=v+this.C_im[t]*c+this.C_re[t]*h;for(var m=0;m<this.iterations;m++){var g,y,b=p,w=v,E=f,S=l;for(t=2;6>=t;t++)g=b*p-w*v,y=w*p+b*v,b=g,w=y,E+=(t-1)*(this.B_re[t]*b-this.B_im[t]*w),S+=(t-1)*(this.B_im[t]*b+this.B_re[t]*w);b=1,w=0;var x=this.B_re[1],T=this.B_im[1];for(t=2;6>=t;t++)g=b*p-w*v,y=w*p+b*v,b=g,w=y,x+=t*(this.B_re[t]*b-this.B_im[t]*w),T+=t*(this.B_im[t]*b+this.B_re[t]*w);var N=x*x+T*T;p=(E*x+S*T)/N,v=(S*x-E*T)/N}var C=p,k=v,L=1,A=0;for(t=1;9>=t;t++)L*=C,A+=this.D[t]*L;var O=this.lat0+A*r*1e5,M=this.long0+k;return e.x=M,e.y=O,e},n.names=["New_Zealand_Map_Grid","nzmg"]},{}],55:[function(e,t,n){var r=e("../common/tsfnz"),i=e("../common/adjust_lon"),s=e("../common/phi2z"),o=Math.PI/2,u=Math.PI/4,a=1e-10;n.init=function(){this.no_off=this.no_off||!1,this.no_rot=this.no_rot||!1,isNaN(this.k0)&&(this.k0=1);var e=Math.sin(this.lat0),t=Math.cos(this.lat0),n=this.e*e;this.bl=Math.sqrt(1+this.es/(1-this.es)*Math.pow(t,4)),this.al=this.a*this.bl*this.k0*Math.sqrt(1-this.es)/(1-n*n);var s=r(this.e,this.lat0,e),o=this.bl/t*Math.sqrt((1-this.es)/(1-n*n));1>o*o&&(o=1);var u,a;if(isNaN(this.longc)){var f=r(this.e,this.lat1,Math.sin(this.lat1)),l=r(this.e,this.lat2,Math.sin(this.lat2));this.el=this.lat0>=0?(o+Math.sqrt(o*o-1))*Math.pow(s,this.bl):(o-Math.sqrt(o*o-1))*Math.pow(s,this.bl);var c=Math.pow(f,this.bl),h=Math.pow(l,this.bl);u=this.el/c,a=.5*(u-1/u);var p=(this.el*this.el-h*c)/(this.el*this.el+h*c),v=(h-c)/(h+c),m=i(this.long1-this.long2);this.long0=.5*(this.long1+this.long2)-Math.atan(p*Math.tan(.5*this.bl*m)/v)/this.bl,this.long0=i(this.long0);var g=i(this.long1-this.long0);this.gamma0=Math.atan(Math.sin(this.bl*g)/a),this.alpha=Math.asin(o*Math.sin(this.gamma0))}else u=this.lat0>=0?o+Math.sqrt(o*o-1):o-Math.sqrt(o*o-1),this.el=u*Math.pow(s,this.bl),a=.5*(u-1/u),this.gamma0=Math.asin(Math.sin(this.alpha)/o),this.long0=this.longc-Math.asin(a*Math.tan(this.gamma0))/this.bl;this.uc=this.no_off?0:this.lat0>=0?this.al/this.bl*Math.atan2(Math.sqrt(o*o-1),Math.cos(this.alpha)):-1*this.al/this.bl*Math.atan2(Math.sqrt(o*o-1),Math.cos(this.alpha))},n.forward=function(e){var t,n,s,f=e.x,l=e.y,c=i(f-this.long0);if(Math.abs(Math.abs(l)-o)<=a)s=l>0?-1:1,n=this.al/this.bl*Math.log(Math.tan(u+s*this.gamma0*.5)),t=-1*s*o*this.al/this.bl;else{var p=r(this.e,l,Math.sin(l)),v=this.el/Math.pow(p,this.bl),m=.5*(v-1/v),y=.5*(v+1/v),b=Math.sin(this.bl*c),w=(m*Math.sin(this.gamma0)-b*Math.cos(this.gamma0))/y;n=Math.abs(Math.abs(w)-1)<=a?Number.POSITIVE_INFINITY:.5*this.al*Math.log((1-w)/(1+w))/this.bl,t=Math.abs(Math.cos(this.bl*c))<=a?this.al*this.bl*c:this.al*Math.atan2(m*Math.cos(this.gamma0)+b*Math.sin(this.gamma0),Math.cos(this.bl*c))/this.bl}return this.no_rot?(e.x=this.x0+t,e.y=this.y0+n):(t-=this.uc,e.x=this.x0+n*Math.cos(this.alpha)+t*Math.sin(this.alpha),e.y=this.y0+t*Math.cos(this.alpha)-n*Math.sin(this.alpha)),e},n.inverse=function(e){var t,n;this.no_rot?(n=e.y-this.y0,t=e.x-this.x0):(n=(e.x-this.x0)*Math.cos(this.alpha)-(e.y-this.y0)*Math.sin(this.alpha),t=(e.y-this.y0)*Math.cos(this.alpha)+(e.x-this.x0)*Math.sin(this.alpha),t+=this.uc);var r=Math.exp(-1*this.bl*n/this.al),u=.5*(r-1/r),l=.5*(r+1/r),c=Math.sin(this.bl*t/this.al),h=(c*Math.cos(this.gamma0)+u*Math.sin(this.gamma0))/l,p=Math.pow(this.el/Math.sqrt((1+h)/(1-h)),1/this.bl);return Math.abs(h-1)<a?(e.x=this.long0,e.y=o):Math.abs(h+1)<a?(e.x=this.long0,e.y=-1*o):(e.y=s(this.e,p),e.x=i(this.long0-Math.atan2(u*Math.cos(this.gamma0)-c*Math.sin(this.gamma0),Math.cos(this.bl*t/this.al))/this.bl)),e},n.names=["Hotine_Oblique_Mercator","Hotine Oblique Mercator","Hotine_Oblique_Mercator_Azimuth_Natural_Origin","Hotine_Oblique_Mercator_Azimuth_Center","omerc"]},{"../common/adjust_lon":5,"../common/phi2z":16,"../common/tsfnz":24}],56:[function(e,t,n){var r=e("../common/e0fn"),i=e("../common/e1fn"),s=e("../common/e2fn"),o=e("../common/e3fn"),u=e("../common/adjust_lon"),a=e("../common/adjust_lat"),f=e("../common/mlfn"),l=1e-10,c=e("../common/gN"),h=20;n.init=function(){this.temp=this.b/this.a,this.es=1-Math.pow(this.temp,2),this.e=Math.sqrt(this.es),this.e0=r(this.es),this.e1=i(this.es),this.e2=s(this.es),this.e3=o(this.es),this.ml0=this.a*f(this.e0,this.e1,this.e2,this.e3,this.lat0)},n.forward=function(e){var t,n,r,i=e.x,s=e.y,o=u(i-this.long0);if(r=o*Math.sin(s),this.sphere)Math.abs(s)<=l?(t=this.a*o,n=-1*this.a*this.lat0):(t=this.a*Math.sin(r)/Math.tan(s),n=this.a*(a(s-this.lat0)+(1-Math.cos(r))/Math.tan(s)));else if(Math.abs(s)<=l)t=this.a*o,n=-1*this.ml0;else{var h=c(this.a,this.e,Math.sin(s))/Math.tan(s);t=h*Math.sin(r),n=this.a*f(this.e0,this.e1,this.e2,this.e3,s)-this.ml0+h*(1-Math.cos(r))}return e.x=t+this.x0,e.y=n+this.y0,e},n.inverse=function(e){var t,n,r,i,s,o,a,c,p;if(r=e.x-this.x0,i=e.y-this.y0,this.sphere)if(Math.abs(i+this.a*this.lat0)<=l)t=u(r/this.a+this.long0),n=0;else{o=this.lat0+i/this.a,a=r*r/this.a/this.a+o*o,c=o;var d;for(s=h;s;--s)if(d=Math.tan(c),p=-1*(o*(c*d+1)-c-.5*(c*c+a)*d)/((c-o)/d-1),c+=p,Math.abs(p)<=l){n=c;break}t=u(this.long0+Math.asin(r*Math.tan(c)/this.a)/Math.sin(n))}else if(Math.abs(i+this.ml0)<=l)n=0,t=u(this.long0+r/this.a);else{o=(this.ml0+i)/this.a,a=r*r/this.a/this.a+o*o,c=o;var v,g,y,b,w;for(s=h;s;--s)if(w=this.e*Math.sin(c),v=Math.sqrt(1-w*w)*Math.tan(c),g=this.a*f(this.e0,this.e1,this.e2,this.e3,c),y=this.e0-2*this.e1*Math.cos(2*c)+4*this.e2*Math.cos(4*c)-6*this.e3*Math.cos(6*c),b=g/this.a,p=(o*(v*b+1)-b-.5*v*(b*b+a))/(this.es*Math.sin(2*c)*(b*b+a-2*o*b)/(4*v)+(o-b)*(v*y-2/Math.sin(2*c))-y),c-=p,Math.abs(p)<=l){n=c;break}v=Math.sqrt(1-this.es*Math.pow(Math.sin(n),2))*Math.tan(n),t=u(this.long0+Math.asin(r*v/this.a)/Math.sin(n))}return e.x=t,e.y=n,e},n.names=["Polyconic","poly"]},{"../common/adjust_lat":4,"../common/adjust_lon":5,"../common/e0fn":7,"../common/e1fn":8,"../common/e2fn":9,"../common/e3fn":10,"../common/gN":11,"../common/mlfn":14}],57:[function(e,t,n){var r=e("../common/adjust_lon"),i=e("../common/adjust_lat"),s=e("../common/pj_enfn"),o=20,u=e("../common/pj_mlfn"),a=e("../common/pj_inv_mlfn"),f=Math.PI/2,l=1e-10,c=e("../common/asinz");n.init=function(){this.sphere?(this.n=1,this.m=0,this.es=0,this.C_y=Math.sqrt((this.m+1)/this.n),this.C_x=this.C_y/(this.m+1)):this.en=s(this.es)},n.forward=function(e){var t,n,i=e.x,s=e.y;if(i=r(i-this.long0),this.sphere){if(this.m)for(var a=this.n*Math.sin(s),f=o;f;--f){var c=(this.m*s+Math.sin(s)-a)/(this.m+Math.cos(s));if(s-=c,Math.abs(c)<l)break}else s=1!==this.n?Math.asin(this.n*Math.sin(s)):s;t=this.a*this.C_x*i*(this.m+Math.cos(s)),n=this.a*this.C_y*s}else{var p=Math.sin(s),v=Math.cos(s);n=this.a*u(s,p,v,this.en),t=this.a*i*v/Math.sqrt(1-this.es*p*p)}return e.x=t,e.y=n,e},n.inverse=function(e){var t,n,s,o;return e.x-=this.x0,s=e.x/this.a,e.y-=this.y0,t=e.y/this.a,this.sphere?(t/=this.C_y,s/=this.C_x*(this.m+Math.cos(t)),this.m?t=c((this.m*t+Math.sin(t))/this.n):1!==this.n&&(t=c(Math.sin(t)/this.n)),s=r(s+this.long0),t=i(t)):(t=a(e.y/this.a,this.es,this.en),o=Math.abs(t),f>o?(o=Math.sin(t),n=this.long0+e.x*Math.sqrt(1-this.es*o*o)/(this.a*Math.cos(t)),s=r(n)):f>o-l&&(s=this.long0)),e.x=s,e.y=t,e},n.names=["Sinusoidal","sinu"]},{"../common/adjust_lat":4,"../common/adjust_lon":5,"../common/asinz":6,"../common/pj_enfn":17,"../common/pj_inv_mlfn":18,"../common/pj_mlfn":19}],58:[function(e,t,n){n.init=function(){var e=this.lat0;this.lambda0=this.long0;var t=Math.sin(e),n=this.a,r=this.rf,i=1/r,s=2*i-Math.pow(i,2),o=this.e=Math.sqrt(s);this.R=this.k0*n*Math.sqrt(1-s)/(1-s*Math.pow(t,2)),this.alpha=Math.sqrt(1+s/(1-s)*Math.pow(Math.cos(e),4)),this.b0=Math.asin(t/this.alpha);var u=Math.log(Math.tan(Math.PI/4+this.b0/2)),a=Math.log(Math.tan(Math.PI/4+e/2)),f=Math.log((1+o*t)/(1-o*t));this.K=u-this.alpha*a+this.alpha*o/2*f},n.forward=function(e){var t=Math.log(Math.tan(Math.PI/4-e.y/2)),n=this.e/2*Math.log((1+this.e*Math.sin(e.y))/(1-this.e*Math.sin(e.y))),r=-this.alpha*(t+n)+this.K,i=2*(Math.atan(Math.exp(r))-Math.PI/4),s=this.alpha*(e.x-this.lambda0),o=Math.atan(Math.sin(s)/(Math.sin(this.b0)*Math.tan(i)+Math.cos(this.b0)*Math.cos(s))),u=Math.asin(Math.cos(this.b0)*Math.sin(i)-Math.sin(this.b0)*Math.cos(i)*Math.cos(s));return e.y=this.R/2*Math.log((1+Math.sin(u))/(1-Math.sin(u)))+this.y0,e.x=this.R*o+this.x0,e},n.inverse=function(e){for(var t=e.x-this.x0,n=e.y-this.y0,r=t/this.R,i=2*(Math.atan(Math.exp(n/this.R))-Math.PI/4),s=Math.asin(Math.cos(this.b0)*Math.sin(i)+Math.sin(this.b0)*Math.cos(i)*Math.cos(r)),o=Math.atan(Math.sin(r)/(Math.cos(this.b0)*Math.cos(r)-Math.sin(this.b0)*Math.tan(i))),u=this.lambda0+o/this.alpha,a=0,f=s,l=-1e3,c=0;Math.abs(f-l)>1e-7;){if(++c>20)return;a=1/this.alpha*(Math.log(Math.tan(Math.PI/4+s/2))-this.K)+this.e*Math.log(Math.tan(Math.PI/4+Math.asin(this.e*Math.sin(f))/2)),l=f,f=2*Math.atan(Math.exp(a))-Math.PI/2}return e.x=u,e.y=f,e},n.names=["somerc"]},{}],59:[function(e,t,n){var r=Math.PI/2,i=1e-10,s=e("../common/sign"),o=e("../common/msfnz"),u=e("../common/tsfnz"),a=e("../common/phi2z"),f=e("../common/adjust_lon");n.ssfn_=function(e,t,n){return t*=n,Math.tan(.5*(r+e))*Math.pow((1-t)/(1+t),.5*n)},n.init=function(){this.coslat0=Math.cos(this.lat0),this.sinlat0=Math.sin(this.lat0),this.sphere?1===this.k0&&!isNaN(this.lat_ts)&&Math.abs(this.coslat0)<=i&&(this.k0=.5*(1+s(this.lat0)*Math.sin(this.lat_ts))):(Math.abs(this.coslat0)<=i&&(this.con=this.lat0>0?1:-1),this.cons=Math.sqrt(Math.pow(1+this.e,1+this.e)*Math.pow(1-this.e,1-this.e)),1===this.k0&&!isNaN(this.lat_ts)&&Math.abs(this.coslat0)<=i&&(this.k0=.5*this.cons*o(this.e,Math.sin(this.lat_ts),Math.cos(this.lat_ts))/u(this.e,this.con*this.lat_ts,this.con*Math.sin(this.lat_ts))),this.ms1=o(this.e,this.sinlat0,this.coslat0),this.X0=2*Math.atan(this.ssfn_(this.lat0,this.sinlat0,this.e))-r,this.cosX0=Math.cos(this.X0),this.sinX0=Math.sin(this.X0))},n.forward=function(e){var t,n,s,o,a,l,c=e.x,p=e.y,v=Math.sin(p),m=Math.cos(p),g=f(c-this.long0);return Math.abs(Math.abs(c-this.long0)-Math.PI)<=i&&Math.abs(p+this.lat0)<=i?(e.x=NaN,e.y=NaN,e):this.sphere?(t=2*this.k0/(1+this.sinlat0*v+this.coslat0*m*Math.cos(g)),e.x=this.a*t*m*Math.sin(g)+this.x0,e.y=this.a*t*(this.coslat0*v-this.sinlat0*m*Math.cos(g))+this.y0,e):(n=2*Math.atan(this.ssfn_(p,v,this.e))-r,o=Math.cos(n),s=Math.sin(n),Math.abs(this.coslat0)<=i?(a=u(this.e,p*this.con,this.con*v),l=2*this.a*this.k0*a/this.cons,e.x=this.x0+l*Math.sin(c-this.long0),e.y=this.y0-this.con*l*Math.cos(c-this.long0),e):(Math.abs(this.sinlat0)<i?(t=2*this.a*this.k0/(1+o*Math.cos(g)),e.y=t*s):(t=2*this.a*this.k0*this.ms1/(this.cosX0*(1+this.sinX0*s+this.cosX0*o*Math.cos(g))),e.y=t*(this.cosX0*s-this.sinX0*o*Math.cos(g))+this.y0),e.x=t*o*Math.sin(g)+this.x0,e))},n.inverse=function(e){e.x-=this.x0,e.y-=this.y0;var t,n,s,o,u,l=Math.sqrt(e.x*e.x+e.y*e.y);if(this.sphere){var c=2*Math.atan(l/(.5*this.a*this.k0));return t=this.long0,n=this.lat0,i>=l?(e.x=t,e.y=n,e):(n=Math.asin(Math.cos(c)*this.sinlat0+e.y*Math.sin(c)*this.coslat0/l),t=f(Math.abs(this.coslat0)<i?this.lat0>0?this.long0+Math.atan2(e.x,-1*e.y):this.long0+Math.atan2(e.x,e.y):this.long0+Math.atan2(e.x*Math.sin(c),l*this.coslat0*Math.cos(c)-e.y*this.sinlat0*Math.sin(c))),e.x=t,e.y=n,e)}if(Math.abs(this.coslat0)<=i){if(i>=l)return n=this.lat0,t=this.long0,e.x=t,e.y=n,e;e.x*=this.con,e.y*=this.con,s=l*this.cons/(2*this.a*this.k0),n=this.con*a(this.e,s),t=this.con*f(this.con*this.long0+Math.atan2(e.x,-1*e.y))}else o=2*Math.atan(l*this.cosX0/(2*this.a*this.k0*this.ms1)),t=this.long0,i>=l?u=this.X0:(u=Math.asin(Math.cos(o)*this.sinX0+e.y*Math.sin(o)*this.cosX0/l),t=f(this.long0+Math.atan2(e.x*Math.sin(o),l*this.cosX0*Math.cos(o)-e.y*this.sinX0*Math.sin(o)))),n=-1*a(this.e,Math.tan(.5*(r+u)));return e.x=t,e.y=n,e},n.names=["stere"]},{"../common/adjust_lon":5,"../common/msfnz":15,"../common/phi2z":16,"../common/sign":21,"../common/tsfnz":24}],60:[function(e,t,n){var r=e("./gauss"),i=e("../common/adjust_lon");n.init=function(){r.init.apply(this),this.rc&&(this.sinc0=Math.sin(this.phic0),this.cosc0=Math.cos(this.phic0),this.R2=2*this.rc,this.title||(this.title="Oblique Stereographic Alternative"))},n.forward=function(e){var t,n,s,o;return e.x=i(e.x-this.long0),r.forward.apply(this,[e]),t=Math.sin(e.y),n=Math.cos(e.y),s=Math.cos(e.x),o=this.k0*this.R2/(1+this.sinc0*t+this.cosc0*n*s),e.x=o*n*Math.sin(e.x),e.y=o*(this.cosc0*t-this.sinc0*n*s),e.x=this.a*e.x+this.x0,e.y=this.a*e.y+this.y0,e},n.inverse=function(e){var t,n,s,o,u;if(e.x=(e.x-this.x0)/this.a,e.y=(e.y-this.y0)/this.a,e.x/=this.k0,e.y/=this.k0,u=Math.sqrt(e.x*e.x+e.y*e.y)){var a=2*Math.atan2(u,this.R2);t=Math.sin(a),n=Math.cos(a),o=Math.asin(n*this.sinc0+e.y*t*this.cosc0/u),s=Math.atan2(e.x*t,u*this.cosc0*n-e.y*this.sinc0*t)}else o=this.phic0,s=0;return e.x=s,e.y=o,r.inverse.apply(this,[e]),e.x=i(e.x+this.long0),e},n.names=["Stereographic_North_Pole","Oblique_Stereographic","Polar_Stereographic","sterea","Oblique Stereographic Alternative"]},{"../common/adjust_lon":5,"./gauss":45}],61:[function(e,t,n){var r=e("../common/e0fn"),i=e("../common/e1fn"),s=e("../common/e2fn"),o=e("../common/e3fn"),u=e("../common/mlfn"),a=e("../common/adjust_lon"),f=Math.PI/2,l=1e-10,c=e("../common/sign"),h=e("../common/asinz");n.init=function(){this.e0=r(this.es),this.e1=i(this.es),this.e2=s(this.es),this.e3=o(this.es),this.ml0=this.a*u(this.e0,this.e1,this.e2,this.e3,this.lat0)},n.forward=function(e){var t,n,r,i=e.x,s=e.y,o=a(i-this.long0),f=Math.sin(s),l=Math.cos(s);if(this.sphere){var c=l*Math.sin(o);if(Math.abs(Math.abs(c)-1)<1e-10)return 93;n=.5*this.a*this.k0*Math.log((1+c)/(1-c)),t=Math.acos(l*Math.cos(o)/Math.sqrt(1-c*c)),0>s&&(t=-t),r=this.a*this.k0*(t-this.lat0)}else{var h=l*o,p=Math.pow(h,2),d=this.ep2*Math.pow(l,2),v=Math.tan(s),m=Math.pow(v,2);t=1-this.es*Math.pow(f,2);var g=this.a/Math.sqrt(t),y=this.a*u(this.e0,this.e1,this.e2,this.e3,s);n=this.k0*g*h*(1+p/6*(1-m+d+p/20*(5-18*m+Math.pow(m,2)+72*d-58*this.ep2)))+this.x0,r=this.k0*(y-this.ml0+g*v*p*(.5+p/24*(5-m+9*d+4*Math.pow(d,2)+p/30*(61-58*m+Math.pow(m,2)+600*d-330*this.ep2))))+this.y0}return e.x=n,e.y=r,e},n.inverse=function(e){var t,n,r,i,s,o,u=6;if(this.sphere){var p=Math.exp(e.x/(this.a*this.k0)),d=.5*(p-1/p),v=this.lat0+e.y/(this.a*this.k0),g=Math.cos(v);t=Math.sqrt((1-g*g)/(1+d*d)),s=h(t),0>v&&(s=-s),o=0===d&&0===g?this.long0:a(Math.atan2(d,g)+this.long0)}else{var y=e.x-this.x0,b=e.y-this.y0;for(t=(this.ml0+b/this.k0)/this.a,n=t,i=0;r=(t+this.e1*Math.sin(2*n)-this.e2*Math.sin(4*n)+this.e3*Math.sin(6*n))/this.e0-n,n+=r,!(Math.abs(r)<=l);i++)if(i>=u)return 95;if(Math.abs(n)<f){var w=Math.sin(n),E=Math.cos(n),S=Math.tan(n),x=this.ep2*Math.pow(E,2),T=Math.pow(x,2),N=Math.pow(S,2),C=Math.pow(N,2);t=1-this.es*Math.pow(w,2);var L=this.a/Math.sqrt(t),A=L*(1-this.es)/t,O=y/(L*this.k0),M=Math.pow(O,2);s=n-L*S*M/A*(.5-M/24*(5+3*N+10*x-4*T-9*this.ep2-M/30*(61+90*N+298*x+45*C-252*this.ep2-3*T))),o=a(this.long0+O*(1-M/6*(1+2*N+x-M/20*(5-2*x+28*N-3*T+8*this.ep2+24*C)))/E)}else s=f*c(b),o=this.long0}return e.x=o,e.y=s,e},n.names=["Transverse_Mercator","Transverse Mercator","tmerc"]},{"../common/adjust_lon":5,"../common/asinz":6,"../common/e0fn":7,"../common/e1fn":8,"../common/e2fn":9,"../common/e3fn":10,"../common/mlfn":14,"../common/sign":21}],62:[function(e,t,n){var r=.017453292519943295,i=e("./tmerc");n.dependsOn="tmerc",n.init=function(){this.zone&&(this.lat0=0,this.long0=(6*Math.abs(this.zone)-183)*r,this.x0=5e5,this.y0=this.utmSouth?1e7:0,this.k0=.9996,i.init.apply(this),this.forward=i.forward,this.inverse=i.inverse)},n.names=["Universal Transverse Mercator System","utm"]},{"./tmerc":61}],63:[function(e,t,n){var r=e("../common/adjust_lon"),i=Math.PI/2,s=1e-10,o=e("../common/asinz");n.init=function(){this.R=this.a},n.forward=function(e){var t,n,u=e.x,a=e.y,l=r(u-this.long0);Math.abs(a)<=s&&(t=this.x0+this.R*l,n=this.y0);var c=o(2*Math.abs(a/Math.PI));(Math.abs(l)<=s||Math.abs(Math.abs(a)-i)<=s)&&(t=this.x0,n=a>=0?this.y0+Math.PI*this.R*Math.tan(.5*c):this.y0+Math.PI*this.R*-Math.tan(.5*c));var h=.5*Math.abs(Math.PI/l-l/Math.PI),p=h*h,v=Math.sin(c),m=Math.cos(c),y=m/(v+m-1),b=y*y,w=y*(2/v-1),E=w*w,S=Math.PI*this.R*(h*(y-E)+Math.sqrt(p*(y-E)*(y-E)-(E+p)*(b-E)))/(E+p);0>l&&(S=-S),t=this.x0+S;var x=p+y;return S=Math.PI*this.R*(w*x-h*Math.sqrt((E+p)*(p+1)-x*x))/(E+p),n=a>=0?this.y0+S:this.y0-S,e.x=t,e.y=n,e},n.inverse=function(e){var t,n,i,o,u,a,l,c,h,p,v,m,g;return e.x-=this.x0,e.y-=this.y0,v=Math.PI*this.R,i=e.x/v,o=e.y/v,u=i*i+o*o,a=-Math.abs(o)*(1+u),l=a-2*o*o+i*i,c=-2*a+1+2*o*o+u*u,g=o*o/c+(2*l*l*l/c/c/c-9*a*l/c/c)/27,h=(a-l*l/3/c)/c,p=2*Math.sqrt(-h/3),v=3*g/h/p,Math.abs(v)>1&&(v=v>=0?1:-1),m=Math.acos(v)/3,n=e.y>=0?(-p*Math.cos(m+Math.PI/3)-l/3/c)*Math.PI:-(-p*Math.cos(m+Math.PI/3)-l/3/c)*Math.PI,t=Math.abs(i)<s?this.long0:r(this.long0+Math.PI*(u-1+Math.sqrt(1+2*(i*i-o*o)+u*u))/2/i),e.x=t,e.y=n,e},n.names=["Van_der_Grinten_I","VanDerGrinten","vandg"]},{"../common/adjust_lon":5,"../common/asinz":6}],64:[function(e,t){var n=.017453292519943295,r=57.29577951308232,i=1,s=2,o=e("./datum_transform"),u=e("./adjust_axis"),a=e("./Proj"),f=e("./common/toPoint");t.exports=function l(e,t,p){function v(e,t){return(e.datum.datum_type===i||e.datum.datum_type===s)&&"WGS84"!==t.datumCode}var m;return Array.isArray(p)&&(p=f(p)),e.datum&&t.datum&&(v(e,t)||v(t,e))&&(m=new a("WGS84"),l(e,m,p),e=m),"enu"!==e.axis&&u(e,!1,p),"longlat"===e.projName?(p.x*=n,p.y*=n):(e.to_meter&&(p.x*=e.to_meter,p.y*=e.to_meter),e.inverse(p)),e.from_greenwich&&(p.x+=e.from_greenwich),p=o(e.datum,t.datum,p),t.from_greenwich&&(p.x-=t.from_greenwich),"longlat"===t.projName?(p.x*=r,p.y*=r):(t.forward(p),t.to_meter&&(p.x/=t.to_meter,p.y/=t.to_meter)),"enu"!==t.axis&&u(t,!0,p),p}},{"./Proj":2,"./adjust_axis":3,"./common/toPoint":23,"./datum_transform":30}],65:[function(e,t){function n(e,t,n){e[t]=n.map(function(e){var t={};return r(e,t),t}).reduce(function(e,t){return a(e,t)},{})}function r(e,t){var i;return Array.isArray(e)?(i=e.shift(),"PARAMETER"===i&&(i=e.shift()),void (1===e.length?Array.isArray(e[0])?(t[i]={},r(e[0],t[i])):t[i]=e[0]:e.length?"TOWGS84"===i?t[i]=e:(t[i]={},["UNIT","PRIMEM","VERT_DATUM"].indexOf(i)>-1?(t[i]={name:e[0].toLowerCase(),convert:e[1]},3===e.length&&(t[i].auth=e[2])):"SPHEROID"===i?(t[i]={name:e[0],a:e[1],rf:e[2]},4===e.length&&(t[i].auth=e[3])):["GEOGCS","GEOCCS","DATUM","VERT_CS","COMPD_CS","LOCAL_CS","FITTED_CS","LOCAL_DATUM"].indexOf(i)>-1?(e[0]=["name",e[0]],n(t,i,e)):e.every(function(e){return Array.isArray(e)})?n(t,i,e):r(e,t[i])):t[i]=!0)):void (t[e]=!0)}function i(e,t){var n=t[0],r=t[1];!(n in e)&&r in e&&(e[n]=e[r],3===t.length&&(e[n]=t[2](e[n])))}function s(e){return e*u}function o(e){function t(t){var n=e.to_meter||1;return parseFloat(t,10)*n}"GEOGCS"===e.type?e.projName="longlat":"LOCAL_CS"===e.type?(e.projName="identity",e.local=!0):e.projName="object"==typeof e.PROJECTION?Object.keys(e.PROJECTION)[0]:e.PROJECTION,e.UNIT&&(e.units=e.UNIT.name.toLowerCase(),"metre"===e.units&&(e.units="meter"),e.UNIT.convert&&(e.to_meter=parseFloat(e.UNIT.convert,10))),e.GEOGCS&&(e.datumCode=e.GEOGCS.DATUM?e.GEOGCS.DATUM.name.toLowerCase():e.GEOGCS.name.toLowerCase(),"d_"===e.datumCode.slice(0,2)&&(e.datumCode=e.datumCode.slice(2)),("new_zealand_geodetic_datum_1949"===e.datumCode||"new_zealand_1949"===e.datumCode)&&(e.datumCode="nzgd49"),"wgs_1984"===e.datumCode&&("Mercator_Auxiliary_Sphere"===e.PROJECTION&&(e.sphere=!0),e.datumCode="wgs84"),"_ferro"===e.datumCode.slice(-6)&&(e.datumCode=e.datumCode.slice(0,-6)),"_jakarta"===e.datumCode.slice(-8)&&(e.datumCode=e.datumCode.slice(0,-8)),~e.datumCode.indexOf("belge")&&(e.datumCode="rnb72"),e.GEOGCS.DATUM&&e.GEOGCS.DATUM.SPHEROID&&(e.ellps=e.GEOGCS.DATUM.SPHEROID.name.replace("_19","").replace(/[Cc]larke\_18/,"clrk"),"international"===e.ellps.toLowerCase().slice(0,13)&&(e.ellps="intl"),e.a=e.GEOGCS.DATUM.SPHEROID.a,e.rf=parseFloat(e.GEOGCS.DATUM.SPHEROID.rf,10)),~e.datumCode.indexOf("osgb_1936")&&(e.datumCode="osgb36")),e.b&&!isFinite(e.b)&&(e.b=e.a);var n=function(t){return i(e,t)},r=[["standard_parallel_1","Standard_Parallel_1"],["standard_parallel_2","Standard_Parallel_2"],["false_easting","False_Easting"],["false_northing","False_Northing"],["central_meridian","Central_Meridian"],["latitude_of_origin","Latitude_Of_Origin"],["scale_factor","Scale_Factor"],["k0","scale_factor"],["latitude_of_center","Latitude_of_center"],["lat0","latitude_of_center",s],["longitude_of_center","Longitude_Of_Center"],["longc","longitude_of_center",s],["x0","false_easting",t],["y0","false_northing",t],["long0","central_meridian",s],["lat0","latitude_of_origin",s],["lat0","standard_parallel_1",s],["lat1","standard_parallel_1",s],["lat2","standard_parallel_2",s],["alpha","azimuth",s],["srsCode","name"]];r.forEach(n),e.long0||!e.longc||"Albers_Conic_Equal_Area"!==e.PROJECTION&&"Lambert_Azimuthal_Equal_Area"!==e.PROJECTION||(e.long0=e.longc)}var u=.017453292519943295,a=e("./extend");t.exports=function(e,t){var n=JSON.parse((","+e).replace(/\s*\,\s*([A-Z_0-9]+?)(\[)/g,',["$1",').slice(1).replace(/\s*\,\s*([A-Z_0-9]+?)\]/g,',"$1"]')),i=n.shift(),s=n.shift();n.unshift(["name",s]),n.unshift(["type",i]),n.unshift("output");var u={};return r(n,u),o(u.output),a(t,u.output)}},{"./extend":33}],66:[function(e,t,n){function r(e){return e*(Math.PI/180)}function i(e){return 180*(e/Math.PI)}function s(e){var t,n,i,s,o,a,f,l,c,h=e.lat,p=e.lon,d=6378137,v=.00669438,m=.9996,g=r(h),y=r(p);c=Math.floor((p+180)/6)+1,180===p&&(c=60),h>=56&&64>h&&p>=3&&12>p&&(c=32),h>=72&&84>h&&(p>=0&&9>p?c=31:p>=9&&21>p?c=33:p>=21&&33>p?c=35:p>=33&&42>p&&(c=37)),t=6*(c-1)-180+3,l=r(t),n=v/(1-v),i=d/Math.sqrt(1-v*Math.sin(g)*Math.sin(g)),s=Math.tan(g)*Math.tan(g),o=n*Math.cos(g)*Math.cos(g),a=Math.cos(g)*(y-l),f=d*((1-v/4-3*v*v/64-5*v*v*v/256)*g-(3*v/8+3*v*v/32+45*v*v*v/1024)*Math.sin(2*g)+(15*v*v/256+45*v*v*v/1024)*Math.sin(4*g)-35*v*v*v/3072*Math.sin(6*g));var b=m*i*(a+(1-s+o)*a*a*a/6+(5-18*s+s*s+72*o-58*n)*a*a*a*a*a/120)+5e5,w=m*(f+i*Math.tan(g)*(a*a/2+(5-s+9*o+4*o*o)*a*a*a*a/24+(61-58*s+s*s+600*o-330*n)*a*a*a*a*a*a/720));return 0>h&&(w+=1e7),{northing:Math.round(w),easting:Math.round(b),zoneNumber:c,zoneLetter:u(h)}}function o(e){var t=e.northing,n=e.easting,r=e.zoneLetter,s=e.zoneNumber;if(0>s||s>60)return null;var u,a,f,l,c,h,p,d,v,m,g=.9996,y=6378137,b=.00669438,w=(1-Math.sqrt(1-b))/(1+Math.sqrt(1-b)),E=n-5e5,S=t;"N">r&&(S-=1e7),d=6*(s-1)-180+3,u=b/(1-b),p=S/g,v=p/(y*(1-b/4-3*b*b/64-5*b*b*b/256)),m=v+(3*w/2-27*w*w*w/32)*Math.sin(2*v)+(21*w*w/16-55*w*w*w*w/32)*Math.sin(4*v)+151*w*w*w/96*Math.sin(6*v),a=y/Math.sqrt(1-b*Math.sin(m)*Math.sin(m)),f=Math.tan(m)*Math.tan(m),l=u*Math.cos(m)*Math.cos(m),c=y*(1-b)/Math.pow(1-b*Math.sin(m)*Math.sin(m),1.5),h=E/(a*g);var x=m-a*Math.tan(m)/c*(h*h/2-(5+3*f+10*l-4*l*l-9*u)*h*h*h*h/24+(61+90*f+298*l+45*f*f-252*u-3*l*l)*h*h*h*h*h*h/720);x=i(x);var T=(h-(1+2*f+l)*h*h*h/6+(5-2*l+28*f-3*l*l+8*u+24*f*f)*h*h*h*h*h/120)/Math.cos(m);T=d+i(T);var N;if(e.accuracy){var C=o({northing:e.northing+e.accuracy,easting:e.easting+e.accuracy,zoneLetter:e.zoneLetter,zoneNumber:e.zoneNumber});N={top:C.lat,right:C.lon,bottom:x,left:T}}else N={lat:x,lon:T};return N}function u(e){var t="Z";return 84>=e&&e>=72?t="X":72>e&&e>=64?t="W":64>e&&e>=56?t="V":56>e&&e>=48?t="U":48>e&&e>=40?t="T":40>e&&e>=32?t="S":32>e&&e>=24?t="R":24>e&&e>=16?t="Q":16>e&&e>=8?t="P":8>e&&e>=0?t="N":0>e&&e>=-8?t="M":-8>e&&e>=-16?t="L":-16>e&&e>=-24?t="K":-24>e&&e>=-32?t="J":-32>e&&e>=-40?t="H":-40>e&&e>=-48?t="G":-48>e&&e>=-56?t="F":-56>e&&e>=-64?t="E":-64>e&&e>=-72?t="D":-72>e&&e>=-80&&(t="C"),t}function a(e,t){var n=""+e.easting,r=""+e.northing;return e.zoneNumber+e.zoneLetter+f(e.easting,e.northing,e.zoneNumber)+n.substr(n.length-5,t)+r.substr(r.length-5,t)}function f(e,t,n){var r=l(n),i=Math.floor(e/1e5),s=Math.floor(t/1e5)%20;return c(i,s,r)}function l(e){var t=e%m;return 0===t&&(t=m),t}function c(e,t,n){var r=n-1,i=g.charCodeAt(r),s=y.charCodeAt(r),o=i+e-1,u=s+t,a=!1;o>x&&(o=o-x+b-1,a=!0),(o===w||w>i&&o>w||(o>w||w>i)&&a)&&o++,(o===E||E>i&&o>E||(o>E||E>i)&&a)&&(o++,o===w&&o++),o>x&&(o=o-x+b-1),u>S?(u=u-S+b-1,a=!0):a=!1,(u===w||w>s&&u>w||(u>w||w>s)&&a)&&u++,(u===E||E>s&&u>E||(u>E||E>s)&&a)&&(u++,u===w&&u++),u>S&&(u=u-S+b-1);var f=String.fromCharCode(o)+String.fromCharCode(u);return f}function h(e){if(e&&0===e.length)throw"MGRSPoint coverting from nothing";for(var t,n=e.length,r=null,i="",s=0;!/[A-Z]/.test(t=e.charAt(s));){if(s>=2)throw"MGRSPoint bad conversion from: "+e;i+=t,s++}var o=parseInt(i,10);if(0===s||s+3>n)throw"MGRSPoint bad conversion from: "+e;var u=e.charAt(s++);if("A">=u||"B"===u||"Y"===u||u>="Z"||"I"===u||"O"===u)throw"MGRSPoint zone letter "+u+" not handled: "+e;r=e.substring(s,s+=2);for(var a=l(o),f=p(r.charAt(0),a),c=d(r.charAt(1),a);c<v(u);)c+=2e6;var h=n-s;if(h%2!==0)throw"MGRSPoint has to have an even number \nof digits after the zone letter and two 100km letters - front \nhalf for easting meters, second half for \nnorthing meters"+e;var m,g,y,b,w,E=h/2,S=0,x=0;return E>0&&(m=1e5/Math.pow(10,E),g=e.substring(s,s+E),S=parseFloat(g)*m,y=e.substring(s+E),x=parseFloat(y)*m),b=S+f,w=x+c,{easting:b,northing:w,zoneLetter:u,zoneNumber:o,accuracy:m}}function p(e,t){for(var n=g.charCodeAt(t-1),r=1e5,i=!1;n!==e.charCodeAt(0);){if(n++,n===w&&n++,n===E&&n++,n>x){if(i)throw"Bad character: "+e;n=b,i=!0}r+=1e5}return r}function d(e,t){if(e>"V")throw"MGRSPoint given invalid Northing "+e;for(var n=y.charCodeAt(t-1),r=0,i=!1;n!==e.charCodeAt(0);){if(n++,n===w&&n++,n===E&&n++,n>S){if(i)throw"Bad character: "+e;n=b,i=!0}r+=1e5}return r}function v(e){var t;switch(e){case"C":t=11e5;break;case"D":t=2e6;break;case"E":t=28e5;break;case"F":t=37e5;break;case"G":t=46e5;break;case"H":t=55e5;break;case"J":t=64e5;break;case"K":t=73e5;break;case"L":t=82e5;break;case"M":t=91e5;break;case"N":t=0;break;case"P":t=8e5;break;case"Q":t=17e5;break;case"R":t=26e5;break;case"S":t=35e5;break;case"T":t=44e5;break;case"U":t=53e5;break;case"V":t=62e5;break;case"W":t=7e6;break;case"X":t=79e5;break;default:t=-1}if(t>=0)return t;throw"Invalid zone letter: "+e}var m=6,g="AJSAJS",y="AFAFAF",b=65,w=73,E=79,S=86,x=90;n.forward=function(e,t){return t=t||5,a(s({lat:e[1],lon:e[0]}),t)},n.inverse=function(e){var t=o(h(e.toUpperCase()));return[t.left,t.bottom,t.right,t.top]},n.toPoint=function(e){var t=n.inverse(e);return[(t[2]+t[0])/2,(t[3]+t[1])/2]}},{}],67:[function(e,t){t.exports={name:"proj4",version:"2.2.1",description:"Proj4js is a JavaScript library to transform point coordinates from one coordinate system to another, including datum transformations.",main:"lib/index.js",directories:{test:"test",doc:"docs"},scripts:{test:"./node_modules/istanbul/lib/cli.js test ./node_modules/mocha/bin/_mocha test/test.js"},repository:{type:"git",url:"git://github.com/proj4js/proj4js.git"},author:"",license:"MIT",jam:{main:"dist/proj4.js",include:["dist/proj4.js","README.md","AUTHORS","LICENSE.md"]},devDependencies:{"grunt-cli":"~0.1.13",grunt:"~0.4.2","grunt-contrib-connect":"~0.6.0","grunt-contrib-jshint":"~0.8.0",chai:"~1.8.1",mocha:"~1.17.1","grunt-mocha-phantomjs":"~0.4.0",browserify:"~3.24.5","grunt-browserify":"~1.3.0","grunt-contrib-uglify":"~0.3.2",curl:"git://github.com/cujojs/curl.git",istanbul:"~0.2.4",tin:"~0.4.0"},dependencies:{mgrs:"0.0.0"}}},{}],"./includedProjections":[function(e,t){t.exports=e("gWUPNW")},{}],gWUPNW:[function(e,t){var n=[e("./lib/projections/tmerc"),e("./lib/projections/utm"),e("./lib/projections/sterea"),e("./lib/projections/stere"),e("./lib/projections/somerc"),e("./lib/projections/omerc"),e("./lib/projections/lcc"),e("./lib/projections/krovak"),e("./lib/projections/cass"),e("./lib/projections/laea"),e("./lib/projections/aea"),e("./lib/projections/gnom"),e("./lib/projections/cea"),e("./lib/projections/eqc"),e("./lib/projections/poly"),e("./lib/projections/nzmg"),e("./lib/projections/mill"),e("./lib/projections/sinu"),e("./lib/projections/moll"),e("./lib/projections/eqdc"),e("./lib/projections/vandg"),e("./lib/projections/aeqd")];t.exports=function(e){n.forEach(function(t){e.Proj.projections.add(t)})}},{"./lib/projections/aea":39,"./lib/projections/aeqd":40,"./lib/projections/cass":41,"./lib/projections/cea":42,"./lib/projections/eqc":43,"./lib/projections/eqdc":44,"./lib/projections/gnom":46,"./lib/projections/krovak":47,"./lib/projections/laea":48,"./lib/projections/lcc":49,"./lib/projections/mill":52,"./lib/projections/moll":53,"./lib/projections/nzmg":54,"./lib/projections/omerc":55,"./lib/projections/poly":56,"./lib/projections/sinu":57,"./lib/projections/somerc":58,"./lib/projections/stere":59,"./lib/projections/sterea":60,"./lib/projections/tmerc":61,"./lib/projections/utm":62,"./lib/projections/vandg":63}]},{},[35])(35)}),function(e){var t,n;if("function"==typeof define&&define.amd)define(["leaflet","proj4"],e);else if("object"==typeof module&&"object"==typeof module.exports)t=require("leaflet"),n=require("proj4"),module.exports=e(t,n);else{if("undefined"==typeof window.L||"undefined"==typeof window.proj4)throw"Leaflet and proj4 must be loaded first";e(window.L,window.proj4)}}(function(e,t){return e.Proj={},e.Proj._isProj4Obj=function(e){return"undefined"!=typeof e.inverse&&"undefined"!=typeof e.forward},e.Proj.ScaleDependantTransformation=function(e){this.scaleTransforms=e},e.Proj.ScaleDependantTransformation.prototype.transform=function(e,t){return this.scaleTransforms[t].transform(e,t)},e.Proj.ScaleDependantTransformation.prototype.untransform=function(e,t){return this.scaleTransforms[t].untransform(e,t)},e.Proj.Projection=e.Class.extend({initialize:function(n,r){if(e.Proj._isProj4Obj(n))this._proj=n;else{var i=n;if(r)t.defs(i,r);else if(void 0===t.defs[i]){var s=i.split(":");if(s.length>3&&(i=s[s.length-3]+":"+s[s.length-1]),void 0===t.defs[i])throw"No projection definition for code "+i}this._proj=t(i)}},project:function(t){var n=this._proj.forward([t.lng,t.lat]);return new e.Point(n[0],n[1])},unproject:function(t,n){var r=this._proj.inverse([t.x,t.y]);return new e.LatLng(r[1],r[0],n)}}),e.Proj.CRS=e.Class.extend({includes:e.CRS,options:{transformation:new e.Transformation(1,0,-1,0)},initialize:function(t,n,r){var i,s,o,u;if(e.Proj._isProj4Obj(t)?(s=t,i=s.srsCode,u=n||{},this.projection=new e.Proj.Projection(s)):(i=t,o=n,u=r||{},this.projection=new e.Proj.Projection(i,o)),e.Util.setOptions(this,u),this.code=i,this.transformation=this.options.transformation,this.options.origin&&(this.transformation=new e.Transformation(1,-this.options.origin[0],-1,this.options.origin[1])),this.options.scales)this._scales=this.options.scales;else if(this.options.resolutions){this._scales=[];for(var f=this.options.resolutions.length-1;f>=0;f--)this.options.resolutions[f]&&(this._scales[f]=1/this.options.resolutions[f])}},scale:function(e){var t,n,r,i,s=Math.floor(e);return e===s?this._scales[e]:(t=this._scales[s],n=this._scales[s+1],r=n-t,i=e-s,t+r*i)},getSize:function(t){var n,r,i,s=this.options.bounds;return s?(n=this.scale(t),r=this.transformation.transform(s.min,n),i=this.transformation.transform(s.max,n),e.point(Math.abs(i.x-r.x),Math.abs(i.y-r.y))):(n=256*Math.pow(2,t),e.point(n,n))}}),e.Proj.CRS.TMS=e.Proj.CRS.extend({options:{tileSize:256},initialize:function(t,n,r,i){var s,o,u,f,l;e.Proj._isProj4Obj(t)?(u=t,f=n,l=r||{},l.origin=[f[0],f[3]],e.Proj.CRS.prototype.initialize.call(this,u,l)):(s=t,o=n,f=r,l=i||{},l.origin=[f[0],f[3]],e.Proj.CRS.prototype.initialize.call(this,s,o,l)),this.projectedBounds=f,this._sizes=this._calculateSizes()},_calculateSizes:function(){var t,n,r,i,s=[],o=this.projectedBounds;for(n=this._scales.length-1;n>=0;n--)this._scales[n]&&(t=this.options.tileSize/this._scales[n],r=Math.ceil(parseFloat((o[2]-o[0])/t).toPrecision(3))*t*this._scales[n],i=Math.ceil(parseFloat((o[3]-o[1])/t).toPrecision(3))*t*this._scales[n],s[n]=e.point(r,i));return s},getSize:function(e){return this._sizes[e]}}),e.Proj.TileLayer={},e.Proj.TileLayer.TMS=e.TileLayer.extend({options:{continuousWorld:!0},initialize:function(t,n,r){var i,s,o,u,f=!0;if(!(n instanceof e.Proj.CRS.TMS))throw"CRS is not L.Proj.CRS.TMS.";for(e.TileLayer.prototype.initialize.call(this,t,r),this.options.tms=!1,this.crs=n,o=this.crs.projectedBounds,u=this.options.minZoom;u<this.options.maxZoom&&f;u++){var l=(o[3]-o[1])/this._projectedTileSize(u);f=Math.abs(l-Math.round(l))>.001}if(!f){for(i={},u=this.options.minZoom;u<this.options.maxZoom;u++)s=o[1]+Math.ceil((o[3]-o[1])/this._projectedTileSize(u))*this._projectedTileSize(u),i[this.crs.scale(u)]=new e.Transformation(1,-o[0],-1,s);this.crs=new e.Proj.CRS.TMS(this.crs.projection._proj,o,this.crs.options),this.crs.transformation=new e.Proj.ScaleDependantTransformation(i)}},getTileUrl:function(t){var n=this._map.getZoom(),r=Math.ceil((this.crs.projectedBounds[3]-this.crs.projectedBounds[1])/this._projectedTileSize(n));return e.Util.template(this._url,e.Util.extend({s:this._getSubdomain(t),z:this._getZoomForUrl(),x:t.x,y:r-t.y-1},this.options))},_projectedTileSize:function(e){return this.options.tileSize/this.crs.scale(e)}}),e.Proj.GeoJSON=e.GeoJSON.extend({initialize:function(t,n){this._callLevel=0,e.GeoJSON.prototype.initialize.call(this,null,n),t&&this.addData(t)},addData:function(t){var n;t&&(t.crs&&"name"===t.crs.type?n=new e.Proj.CRS(t.crs.properties.name):t.crs&&t.crs.type&&(n=new e.Proj.CRS(t.crs.type+":"+t.crs.properties.code)),void 0!==n&&(this.options.coordsToLatLng=function(t){var r=e.point(t[0],t[1]);return n.projection.unproject(r)})),this._callLevel++;try{e.GeoJSON.prototype.addData.call(this,t)}finally{this._callLevel--,0===this._callLevel&&delete this.options.coordsToLatLng}}}),e.Proj.geoJson=function(t,n){return new e.Proj.GeoJSON(t,n)},e.Proj.ImageOverlay=e.ImageOverlay.extend({initialize:function(t,n,r){e.ImageOverlay.prototype.initialize.call(this,t,null,r),this._projBounds=n},_animateZoom:function(t){var n=e.point(this._projBounds.min.x,this._projBounds.max.y),r=e.point(this._projBounds.max.x,this._projBounds.min.y),i=this._projectedToNewLayerPoint(n,t.zoom,t.center),s=this._projectedToNewLayerPoint(r,t.zoom,t.center).subtract(i),o=i.add(s._multiplyBy((1-1/t.scale)/2));this._image.style[e.DomUtil.TRANSFORM]=e.DomUtil.getTranslateString(o)+" scale("+this._map.getZoomScale(t.zoom)+") "},_reset:function(){var t=this._map.getZoom(),n=this._map.getPixelOrigin(),r=e.bounds(this._transform(this._projBounds.min,t)._subtract(n),this._transform(this._projBounds.max,t)._subtract(n)),i=r.getSize(),s=this._image;e.DomUtil.setPosition(s,r.min),s.style.width=i.x+"px",s.style.height=i.y+"px"},_projectedToNewLayerPoint:function(e,t,n){var r=this._map._getNewTopLeftPoint(n,t).add(this._map._getMapPanePos());return this._transform(e,t)._subtract(r)},_transform:function(e,t){var n=this._map.options.crs,r=n.transformation,i=n.scale(t);return r.transform(e,i)}}),e.Proj.imageOverlay=function(t,n,r){return new e.Proj.ImageOverlay(t,n,r)},"undefined"!=typeof e.CRS&&(e.CRS.proj4js=function(){return function(t,n,r,i){return i=i||{},r&&(i.transformation=r),new e.Proj.CRS(t,n,i)}}()),e.Proj}),function(e,t,n){"undefined"!=typeof t&&"undefined"!=typeof n&&(t.define("PublicaMundi.Leaflet"),_project=function(e){var t=n.CRS.EPSG3857.projection.project(e).multiplyBy(6378137);return t},_unproject=function(e){var t=n.point(e[0],e[1]).divideBy(6378137);return n.CRS.EPSG3857.projection.unproject(t)},t.Leaflet.Map=t.Class(t.Map,{addOverlay:function(e){var t=(new n.popup({className:"hideparent",closeButton:!1})).setLatLng(this._map.getCenter());return t.setContent(e),t.addTo(this._map),this._popup=t,t},getOverlayElement:function(e){return e.getContent()},setOverlayPosition:function(e,t){var n=[t[0]/6378137,t[1]/6378137];e.setLatLng(n)},initialize:function(e){function r(e){i._highlight&&i._lastClicked&&(i._lastClicked.resetStyle(i._highlight),i._highlight=null,i._lastClicked=null)}t.Map.prototype.initialize.call(this,e);var i=this;if(this._lastClicked=null,t.isClass("L.Map")&&e instanceof n.Map?this._map=e:this._map=n.map(e.target,{center:_unproject(e.center),zoom:e.zoom,maxZoom:e.maxZoom,minZoom:e.minZoom,attributionControl:!1,closePopupOnClick:!1}),e.layerControl&&this.setLayerControl(),this._listen(),this._map.on("click",r),"undefined"!=typeof e.layers&&t.isArray(e.layers))for(var s=0;s<e.layers.length;s++)this.createLayer(e.layers[s])},setCenter:function(e,n){t.isArray(e)?this._map.setView(_unproject(e),this._map.getZoom()):this._map.setView(_unproject([e,n]),this._map.getZoom())},getCenter:function(){var e=this._map.getCenter();return e=n.CRS.EPSG3857.projection.project(e).multiplyBy(6378137),[e.x,e.y]},setZoom:function(e){this._map.setView(this._map.getCenter(),e)},getZoom:function(){return this._map.getZoom()},getProjection:function(){return"EPSG:3857"},getTarget:function(){return this._map.getTarget()},addLayer:function(e){e._options.visible!==!1&&(this._map.addLayer(e.getLayer()),e.update()),e._addToControl()},removeLayer:function(e){if(e){this._map.removeLayer(e.getLayer());for(var t=0;t<this._layers.length;t++)if(this._layers[t]==e){this._layers.splice(t,1);break}}},setExtent:function(e,t){if(null!==e){var r;r="EPSG:4326"==t?e:"EPSG:3857"==t?_unproject(e):null;var i=new n.LatLng(r[1],r[0]),s=new n.LatLng(r[3],r[2]);this._map.fitBounds(new n.LatLngBounds(i,s))}},_listen:function(){var e=this;this._map.on("moveend",function(){e._setViewBox();var t=e.getLayers();$.each(t,function(e,t){t.update()})})},_setViewBox:function(){var e=_project(this._map.getBounds().getSouthWest()),t=_project(this._map.getBounds().getNorthEast());this._viewbox=e.x+","+e.y+","+t.x+","+t.y},setLayerControl:function(e){return this._control||(this._control=new n.control.layers,this._control.addTo(this._map)),this._control}}),t.locator.register("PublicaMundi.Map",t.Leaflet.Map))}(window,window.PublicaMundi,L),function(e,t,n){"undefined"!=typeof t&&"undefined"!=typeof n&&(t.define("PublicaMundi.Leaflet.Layer"),t.Leaflet.Layer.WMS=t.Class(t.Layer,{_addToControl:function(){var e=this._map,t=this._options.title;e.getLayerControl()&&e.getLayerControl().addOverlay(this._layer,t)},onLayerLoad:function(){},fitToMap:function(){var e=this,n=this._options;this._layer.once("load",function(r){if("undefined"!=typeof n.bbox)e.getMap().setExtent(n.bbox,"EPSG:4326");else{var i=t.parser(),s=n.url+"?service=WMS&request=GetCapabilities";$.ajax({url:s,success:function(t){var r=i.parseWMS(t),s=r.Layer;for(var o in s){var u=s[o];if(u.Name==n.params.layers)return e._extent=u.EX_GeographicBoundingBox,e.getMap().setExtent(e._extent,"EPSG:4326"),!1}}})}})},initialize:function(e){t.Layer.prototype.initialize.call(this,e),n.Util.isArray(e.url)&&(e.url=e.url[0]),this._layer=n.tileLayer.wms(e.url,{layers:e.params.layers,format:"image/png",transparent:!0})}}),t.registry.registerLayerType({layer:t.LayerType.WMS,framework:t.Leaflet.Framework,type:"PublicaMundi.Layer.WMS",factory:t.Leaflet.Layer.WMS}))}(window,window.PublicaMundi,L),function(e,t,n){"undefined"!=typeof t&&"undefined"!=typeof n&&(t.define("PublicaMundi.Leaflet.Layer"),t.Leaflet.Layer.WFS=t.Class(t.Layer,{_addToControl:function(){var e=this._map,t=this._options.title;e.getLayerControl()&&e.getLayerControl().addOverlay(this._layer,t)},fitToMap:function(){var e=this;this._options,this._layer.once("layeradd",function(){this._map.setExtent(e._extent,"EPSG:4326")})},update:function(){"0,0,0,0"==this._map._getViewBox()&&this._map._setViewBox();var e=this._map._getViewBox();$.ajax({type:"GET",url:this._options.url,data:{service:"WFS",request:"GetFeature",typename:this._options.params.layers,srsname:"EPSG:4326",outputFormat:"json",bbox:e+",EPSG:3857"},dataType:"json",context:this,success:function(e){this._layer.clearLayers(),this._layer.addData(e)}})},initialize:function(e){function r(e){var n=e.target,r=i._style.highlight;t.isFunction(r)&&(r=r(n.feature)),n.setStyle(r)}t.Layer.prototype.initialize.call(this,e),e.style=e.style||{normal:{},highlight:{}},this._style=e.style,this._style=e.style||{normal:{},highlight:{}},this._style.normal=e.style.normal||this._style.normal,this._style.highlight=e.style.highlight||this._style.highlight;var i=this,s=null;t.isFunction(e.click)&&(s=function(t){e.click([t.target.feature.properties],[6378137*t.latlng.lat,6378137*t.latlng.lng]),map._highlight?map._highlight!==t.target&&(map._lastClicked.resetStyle(map._highlight),map._lastClicked=i._layer,map._highlight=t.target,r(t)):(map._lastClicked&&map._lastClicked.resetStyle(map._highlight),map._lastClicked=i._layer,map._highlight=t.target,r(t))}),this._layer=n.geoJson(null,{style:this._style.normal,pointToLayer:function(e,t){return n.circleMarker(t,{radius:5,fillColor:"#FFFFFF",fillOpacity:.4,color:"#3399CC",weight:1.25,opacity:1})},onEachFeature:function(e,n){t.isFunction(s)&&n.on({click:s})}})}}),t.registry.registerLayerType({layer:t.LayerType.WFS,framework:t.Leaflet.Framework,type:"PublicaMundi.Layer.WFS",factory:t.Leaflet.Layer.WFS}))}(window,window.PublicaMundi,L),function(e,t,n){"undefined"!=typeof t&&"undefined"!=typeof n&&(t.define("PublicaMundi.Leaflet.Layer"),t.Leaflet.Layer.Tile=t.Class(t.Layer,{initialize:function(e){t.Layer.prototype.initialize.call(this,e),this._layer=n.tileLayer(e.url)},_addToControl:function(){this._map.getLayerControl()&&this._map.getLayerControl().addBaseLayer(this._layer,this._options.title)}}),t.registry.registerLayerType({layer:t.LayerType.TILE,framework:t.Leaflet.Framework,type:"PublicaMundi.Layer.Tile",factory:t.Leaflet.Layer.Tile}))}(window,window.PublicaMundi,L),function(e,t,n,r){"undefined"!=typeof t&&"undefined"!=typeof n&&(t.define("PublicaMundi.Leaflet.Layer"),t.Leaflet.Layer.KML=t.Class(t.Layer,{fitToMap:function(){},_addToControl:function(){this._map.getLayerControl()&&this._map.getLayerControl().addOverlay(this._layer,this._options.title)},initialize:function(e){function i(e){var n=e.target,r=o._style.highlight;t.isFunction(r)&&(r=r(n.feature)),n.setStyle(r)}t.Layer.prototype.initialize.call(this,e),e.style=e.style||{normal:{},highlight:{}},this._style=e.style,this._style.normal=e.style.normal||this._style.normal,this._style.highlight=e.style.highlight||this._style.highlight,!t.isDefined(e.projection);var s=null;if(t.isFunction(e.click)){var o=(this._style.highlight,this);s=function(t){e.click([t.target.feature.properties],[6378137*t.latlng.lat,6378137*t.latlng.lng]),map._highlight?map._highlight!==t.target&&(map._lastClicked.resetStyle(map._highlight),map._lastClicked=o._layer,map._highlight=t.target,i(t)):(map._lastClicked&&map._lastClicked.resetStyle(map._highlight),map._lastClicked=o._layer,map._highlight=t.target,i(t))}}this._layer=n.geoJson(null,{style:this._style.normal,pointToLayer:function(e,t){return n.circleMarker(t,{radius:5,fillColor:"#FFFFFF",fillOpacity:.4,color:"#3399CC",weight:1.25,opacity:1})},onEachFeature:function(e,n){t.isFunction(s)&&n.on({click:s})}}),r.ajax({type:"GET",url:e.url,dataType:"xml",async:!0,context:this,beforeSend:function(){},complete:function(){},success:function(e){var t=toGeoJSON.kml(e);this._layer.addData(t),r.event.trigger({type:"layerLoaded"});var n=this._layer.getBounds(),i=n.getSouthWest(),s=n.getNorthEast();this._extent=[i.lng,i.lat,s.lng,s.lat]},failure:function(e){console.log("failed"),console.log(e)}})}}),t.registry.registerLayerType({layer:t.LayerType.KML,framework:t.Leaflet.Framework,type:"PublicaMundi.Layer.KML",factory:t.Leaflet.Layer.KML}),t.isDefined(t.Map)&&(t.Map.prototype.KML=function(e){return e.type=t.LayerType.KML,this.createLayer(e)}))}(window,window.PublicaMundi,L,jQuery),function(e,t,n,r){if("undefined"!=typeof t&&"undefined"!=typeof n){t.define("PublicaMundi.Leaflet.Layer");var i;t.Leaflet.Layer.GeoJson=t.Class(t.Layer,{_addToControl:function(){this._map.getLayerControl()&&this._map.getLayerControl().addOverlay(this._layer,this._options.title)},onLayerLoad:function(){},fitToMap:function(){},initialize:function(e){t.Layer.prototype.initialize.call(this,e),e.style=e.style||{normal:{},highlight:{}},this._style.normal=e.style.normal||this._style.normal,this._style.highlight=e.style.highlight||this._style.highlight;var s=this;t.isDefined(e.projection)||(e.projection="EPSG:3857");var o=null;t.isFunction(e.click)&&(o=function(n){function r(e){var n=e.target,r=s._style.highlight;t.isFunction(r)&&(r=r(n.feature)),n.setStyle(r)}e.click([n.target.feature.properties],[6378137*n.latlng.lat,6378137*n.latlng.lng]),map._highlight?map._highlight!==n.target&&(map._lastClicked.resetStyle(map._highlight),map._lastClicked=s._layer,map._highlight=n.target,r(n)):(map._lastClicked&&map._lastClicked.resetStyle(map._highlight),map._lastClicked=s._layer,map._highlight=n.target,r(n))}),this._layer=n.Proj.geoJson(null,{style:this._style.normal,pointToLayer:function(e,t){return n.circleMarker(t,{radius:5,fillColor:"#FFFFFF",fillOpacity:.4,color:"#3399CC",weight:1.25,opacity:1})},onEachFeature:function(e,n){t.isFunction(o)&&n.on({click:o})}}),e.text&&!e.data&&(e.data=JSON.parse(e.text)),e.data&&"Feature"==e.data.type&&(e.data={type:"FeatureCollection",features:[e.data]}),"undefined"==typeof e.data.crs&&(e.data.crs={type:"name",properties:{name:"urn:ogc:def:crs:EPSG::"+e.projection.split(":")[1]}}),e.url?i=r.ajax({type:"GET",url:e.url,dataType:"json",async:!0,context:this,beforeSend:function(){},complete:function(){},success:function(e){this._layer.addData(e)},failure:function(e){}}):e.data&&this._layer.addData(e.data)}}),t.registry.registerLayerType({layer:t.LayerType.GeoJSON,framework:t.Leaflet.Framework,type:"PublicaMundi.Layer.GeoJson",factory:t.Leaflet.Layer.GeoJson}),t.isDefined(t.Map)&&(t.Map.prototype.geoJSON=function(e){return e.type=t.LayerType.GeoJSON,this.createLayer(e)})}}(window,window.PublicaMundi,L,jQuery);